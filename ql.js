"use strict";var u=require("path"),t=require("fs");require("crypto");var e=require("zlib"),n=require("nodemailer"),r=require("got");function i(u){return u&&"object"==typeof u&&"default"in u?u:{default:u}}function o(u){if(u&&u.__esModule)return u;var t=Object.create(null);return u&&Object.keys(u).forEach((function(e){if("default"!==e){var n=Object.getOwnPropertyDescriptor(u,e);Object.defineProperty(t,e,n.get?n:{enumerable:!0,get:function(){return u[e]}})}})),t.default=u,Object.freeze(t)}var a,s=o(u),c=o(t),D=o(n),f=i(r);!function(u){u[u.SUCCESS=0]="SUCCESS",u[u["应用程序不存在或已被封禁"]=-1]="应用程序不存在或已被封禁",u[u["Access Key错误"]=-2]="Access Key错误",u[u["API校验密匙错误"]=-3]="API校验密匙错误",u[u["调用方对该Method没有权限"]=-4]="调用方对该Method没有权限",u[u["账号未登录"]=-101]="账号未登录",u[u["账号被封停"]=-102]="账号被封停",u[u["积分不足"]=-103]="积分不足",u[u["硬币不足"]=-104]="硬币不足",u[u["验证码错误"]=-105]="验证码错误",u[u["账号非正式会员或在适应期"]=-106]="账号非正式会员或在适应期",u[u["应用不存在或者被封禁"]=-107]="应用不存在或者被封禁",u[u["未绑定手机?"]=-108]="未绑定手机?",u[u["未绑定手机"]=-110]="未绑定手机",u[u["csrf 校验失败"]=-111]="csrf 校验失败",u[u["系统升级中"]=-112]="系统升级中",u[u["账号尚未实名认证"]=-113]="账号尚未实名认证",u[u["请先绑定手机"]=-114]="请先绑定手机",u[u["请先完成实名认证"]=-115]="请先完成实名认证"}(a||(a={}));const l="https://account.bilibili.com",d="https://live.bilibili.com",C="https://space.bilibili.com",p="https://message.bilibili.com",F="https://www.bilibili.com",A="https://www.bilibili.com/",E="https://account.bilibili.com",g="https://api.live.bilibili.com",m="https://api.bilibili.com",h="https://manga.bilibili.com",y="https://api.vc.bilibili.com",B={"user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.41 Safari/537.36 Edg/101.0.1210.32","content-type":"application/x-www-form-urlencoded; charset=UTF-8","accept-language":"zh-CN,zh;q=0.9","accept-encoding":"gzip, deflate, br"},w=["棒","棒唉","棒耶","加油~","UP加油!","支持~","支持支持！","催更啦","顶顶","留下脚印~","干杯","bilibili干杯","o(*￣▽￣*)o","(｡･∀･)ﾉﾞ嗨","(●ˇ∀ˇ●)","( •̀ ω •́ )y","(ง •_•)ง",">.<","^_~"],v=Object.prototype.toString;function _(u,t){return v.call(u)===`[object ${t}]`}function b(u){return null!==u&&_(u,"Object")}function $(u){return _(u,"String")}function S(u){return u&&Array.isArray(u)}function T(){const u=new Date,t=u.getTime(),e=u.getTimezoneOffset()/60;return new Date(t+36e5*(e+8))}function I(u,t){return Math.ceil(t/u)}function O(u,t,e){if(e&&"boolean"!=typeof e&&(t=e=void 0),void 0===e&&("boolean"==typeof t?(e=t,t=void 0):"boolean"==typeof u&&(e=u,u=void 0)),void 0===u&&void 0===t?(u=0,t=1):void 0===t&&(t=u,u=0),u>t){const e=u;u=t,t=e}if(e||u%1||t%1){const e=Math.random();return Math.min(u+e*(t-u+parseFloat("1e-"+((e+"").length-1))),t)}return u+Math.floor(Math.random()*(t-u+1))}function P(){return`${O(1,9)}${function(u,t){let e="";for(let t=0;t<u;t++)e+=U("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ");return t?e.toLowerCase():e}(10,!0)}0`}function x(u,t){u.includes(t)||u.push(t)}function L(u,t=!1){return b(u)?Array.isArray(u)?u.map((u=>L(u,t))):t?Object.keys(u).reduce(((e,n)=>(e[n]=L(u[n],t),e)),{}):Object.assign({},u):u}function k(u,t){return void 0===u||void 0===t?u||t:b(u)&&b(t)?Array.isArray(u)&&Array.isArray(t)?u.concat(t):Object.keys(t).reduce(((e,n)=>(e[n]=k(u[n],t[n]),e)),u):t}function N(u){if(!b(u)&&!S(u))return u;const t=new URLSearchParams;return Array.isArray(u)||(u=Object.entries(u)),u.forEach((([u,e])=>{b(e)?t.append(u,JSON.stringify(e)):t.append(u,String(e))})),t.toString()}function U(u){return u[O(u.length-1)]}function R(u){return u&&u.map((u=>Number(u))).filter((u=>u>0&&u%1==0))}var j="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},G=function(u){return u&&u.Math==Math&&u},M=G("object"==typeof globalThis&&globalThis)||G("object"==typeof window&&window)||G("object"==typeof self&&self)||G("object"==typeof j&&j)||function(){return this}()||Function("return this")(),q={},H=function(u){try{return!!u()}catch(u){return!0}},J=!H((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),K=!H((function(){var u=function(){}.bind();return"function"!=typeof u||u.hasOwnProperty("prototype")})),z=K,Y=Function.prototype.call,Q=z?Y.bind(Y):function(){return Y.apply(Y,arguments)},V={},W={}.propertyIsEnumerable,X=Object.getOwnPropertyDescriptor,Z=X&&!W.call({1:2},1);V.f=Z?function(u){var t=X(this,u);return!!t&&t.enumerable}:W;var uu,tu,eu=function(u,t){return{enumerable:!(1&u),configurable:!(2&u),writable:!(4&u),value:t}},nu=K,ru=Function.prototype,iu=ru.bind,ou=ru.call,au=nu&&iu.bind(ou,ou),su=nu?function(u){return u&&au(u)}:function(u){return u&&function(){return ou.apply(u,arguments)}},cu=su,Du=cu({}.toString),fu=cu("".slice),lu=function(u){return fu(Du(u),8,-1)},du=H,Cu=lu,pu=Object,Fu=su("".split),Au=du((function(){return!pu("z").propertyIsEnumerable(0)}))?function(u){return"String"==Cu(u)?Fu(u,""):pu(u)}:pu,Eu=TypeError,gu=function(u){if(null==u)throw Eu("Can't call method on "+u);return u},mu=Au,hu=gu,yu=function(u){return mu(hu(u))},Bu=function(u){return"function"==typeof u},wu=Bu,vu=function(u){return"object"==typeof u?null!==u:wu(u)},_u=M,bu=Bu,$u=function(u){return bu(u)?u:void 0},Su=function(u,t){return arguments.length<2?$u(_u[u]):_u[u]&&_u[u][t]},Tu=su({}.isPrototypeOf),Iu=M,Ou=Su("navigator","userAgent")||"",Pu=Iu.process,xu=Iu.Deno,Lu=Pu&&Pu.versions||xu&&xu.version,ku=Lu&&Lu.v8;ku&&(tu=(uu=ku.split("."))[0]>0&&uu[0]<4?1:+(uu[0]+uu[1])),!tu&&Ou&&(!(uu=Ou.match(/Edge\/(\d+)/))||uu[1]>=74)&&(uu=Ou.match(/Chrome\/(\d+)/))&&(tu=+uu[1]);var Nu=tu,Uu=H,Ru=!!Object.getOwnPropertySymbols&&!Uu((function(){var u=Symbol();return!String(u)||!(Object(u)instanceof Symbol)||!Symbol.sham&&Nu&&Nu<41})),ju=Ru&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Gu=Su,Mu=Bu,qu=Tu,Hu=Object,Ju=ju?function(u){return"symbol"==typeof u}:function(u){var t=Gu("Symbol");return Mu(t)&&qu(t.prototype,Hu(u))},Ku=String,zu=Bu,Yu=function(u){try{return Ku(u)}catch(u){return"Object"}},Qu=TypeError,Vu=function(u){if(zu(u))return u;throw Qu(Yu(u)+" is not a function")},Wu=Q,Xu=Bu,Zu=vu,ut=TypeError,tt={exports:{}},et=M,nt=Object.defineProperty,rt=function(u,t){try{nt(et,u,{value:t,configurable:!0,writable:!0})}catch(e){et[u]=t}return t},it=rt,ot=M["__core-js_shared__"]||it("__core-js_shared__",{}),at=ot;(tt.exports=function(u,t){return at[u]||(at[u]=void 0!==t?t:{})})("versions",[]).push({version:"3.22.8",mode:"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.22.8/LICENSE",source:"https://github.com/zloirock/core-js"});var st=gu,ct=Object,Dt=function(u){return ct(st(u))},ft=su({}.hasOwnProperty),lt=Object.hasOwn||function(u,t){return ft(Dt(u),t)},dt=su,Ct=0,pt=Math.random(),Ft=dt(1..toString),At=function(u){return"Symbol("+(void 0===u?"":u)+")_"+Ft(++Ct+pt,36)},Et=M,gt=tt.exports,mt=lt,ht=At,yt=Ru,Bt=ju,wt=gt("wks"),vt=Et.Symbol,_t=vt&&vt.for,bt=Bt?vt:vt&&vt.withoutSetter||ht,$t=function(u){if(!mt(wt,u)||!yt&&"string"!=typeof wt[u]){var t="Symbol."+u;yt&&mt(vt,u)?wt[u]=vt[u]:wt[u]=Bt&&_t?_t(t):bt(t)}return wt[u]},St=Q,Tt=vu,It=Ju,Ot=function(u,t){var e=u[t];return null==e?void 0:Vu(e)},Pt=function(u,t){var e,n;if("string"===t&&Xu(e=u.toString)&&!Zu(n=Wu(e,u)))return n;if(Xu(e=u.valueOf)&&!Zu(n=Wu(e,u)))return n;if("string"!==t&&Xu(e=u.toString)&&!Zu(n=Wu(e,u)))return n;throw ut("Can't convert object to primitive value")},xt=TypeError,Lt=$t("toPrimitive"),kt=function(u,t){if(!Tt(u)||It(u))return u;var e,n=Ot(u,Lt);if(n){if(void 0===t&&(t="default"),e=St(n,u,t),!Tt(e)||It(e))return e;throw xt("Can't convert object to primitive value")}return void 0===t&&(t="number"),Pt(u,t)},Nt=Ju,Ut=function(u){var t=kt(u,"string");return Nt(t)?t:t+""},Rt=vu,jt=M.document,Gt=Rt(jt)&&Rt(jt.createElement),Mt=function(u){return Gt?jt.createElement(u):{}},qt=!J&&!H((function(){return 7!=Object.defineProperty(Mt("div"),"a",{get:function(){return 7}}).a})),Ht=J,Jt=Q,Kt=V,zt=eu,Yt=yu,Qt=Ut,Vt=lt,Wt=qt,Xt=Object.getOwnPropertyDescriptor;q.f=Ht?Xt:function(u,t){if(u=Yt(u),t=Qt(t),Wt)try{return Xt(u,t)}catch(u){}if(Vt(u,t))return zt(!Jt(Kt.f,u,t),u[t])};var Zt={},ue=J&&H((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),te=vu,ee=String,ne=TypeError,re=function(u){if(te(u))return u;throw ne(ee(u)+" is not an object")},ie=J,oe=qt,ae=ue,se=re,ce=Ut,De=TypeError,fe=Object.defineProperty,le=Object.getOwnPropertyDescriptor;Zt.f=ie?ae?function(u,t,e){if(se(u),t=ce(t),se(e),"function"==typeof u&&"prototype"===t&&"value"in e&&"writable"in e&&!e.writable){var n=le(u,t);n&&n.writable&&(u[t]=e.value,e={configurable:"configurable"in e?e.configurable:n.configurable,enumerable:"enumerable"in e?e.enumerable:n.enumerable,writable:!1})}return fe(u,t,e)}:fe:function(u,t,e){if(se(u),t=ce(t),se(e),oe)try{return fe(u,t,e)}catch(u){}if("get"in e||"set"in e)throw De("Accessors not supported");return"value"in e&&(u[t]=e.value),u};var de=Zt,Ce=eu,pe=J?function(u,t,e){return de.f(u,t,Ce(1,e))}:function(u,t,e){return u[t]=e,u},Fe={exports:{}},Ae=J,Ee=lt,ge=Function.prototype,me=Ae&&Object.getOwnPropertyDescriptor,he=Ee(ge,"name"),ye={EXISTS:he,PROPER:he&&"something"===function(){}.name,CONFIGURABLE:he&&(!Ae||Ae&&me(ge,"name").configurable)},Be=Bu,we=ot,ve=su(Function.toString);Be(we.inspectSource)||(we.inspectSource=function(u){return ve(u)});var _e,be,$e,Se=we.inspectSource,Te=Bu,Ie=Se,Oe=M.WeakMap,Pe=Te(Oe)&&/native code/.test(Ie(Oe)),xe=tt.exports,Le=At,ke=xe("keys"),Ne={},Ue=Pe,Re=M,je=su,Ge=vu,Me=pe,qe=lt,He=ot,Je=function(u){return ke[u]||(ke[u]=Le(u))},Ke=Ne,ze=Re.TypeError,Ye=Re.WeakMap;if(Ue||He.state){var Qe=He.state||(He.state=new Ye),Ve=je(Qe.get),We=je(Qe.has),Xe=je(Qe.set);_e=function(u,t){if(We(Qe,u))throw new ze("Object already initialized");return t.facade=u,Xe(Qe,u,t),t},be=function(u){return Ve(Qe,u)||{}},$e=function(u){return We(Qe,u)}}else{var Ze=Je("state");Ke[Ze]=!0,_e=function(u,t){if(qe(u,Ze))throw new ze("Object already initialized");return t.facade=u,Me(u,Ze,t),t},be=function(u){return qe(u,Ze)?u[Ze]:{}},$e=function(u){return qe(u,Ze)}}var un={set:_e,get:be,has:$e,enforce:function(u){return $e(u)?be(u):_e(u,{})},getterFor:function(u){return function(t){var e;if(!Ge(t)||(e=be(t)).type!==u)throw ze("Incompatible receiver, "+u+" required");return e}}},tn=H,en=Bu,nn=lt,rn=J,on=ye.CONFIGURABLE,an=Se,sn=un.enforce,cn=un.get,Dn=Object.defineProperty,fn=rn&&!tn((function(){return 8!==Dn((function(){}),"length",{value:8}).length})),ln=String(String).split("String"),dn=Fe.exports=function(u,t,e){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),e&&e.getter&&(t="get "+t),e&&e.setter&&(t="set "+t),(!nn(u,"name")||on&&u.name!==t)&&Dn(u,"name",{value:t,configurable:!0}),fn&&e&&nn(e,"arity")&&u.length!==e.arity&&Dn(u,"length",{value:e.arity});try{e&&nn(e,"constructor")&&e.constructor?rn&&Dn(u,"prototype",{writable:!1}):u.prototype&&(u.prototype=void 0)}catch(u){}var n=sn(u);return nn(n,"source")||(n.source=ln.join("string"==typeof t?t:"")),u};Function.prototype.toString=dn((function(){return en(this)&&cn(this).source||an(this)}),"toString");var Cn=Bu,pn=pe,Fn=Fe.exports,An=rt,En={},gn=Math.ceil,mn=Math.floor,hn=Math.trunc||function(u){var t=+u;return(t>0?mn:gn)(t)},yn=function(u){var t=+u;return t!=t||0===t?0:hn(t)},Bn=yn,wn=Math.max,vn=Math.min,_n=yn,bn=Math.min,$n=function(u){return u>0?bn(_n(u),9007199254740991):0},Sn=yu,Tn=function(u,t){var e=Bn(u);return e<0?wn(e+t,0):vn(e,t)},In=function(u){return $n(u.length)},On=function(u){return function(t,e,n){var r,i=Sn(t),o=In(i),a=Tn(n,o);if(u&&e!=e){for(;o>a;)if((r=i[a++])!=r)return!0}else for(;o>a;a++)if((u||a in i)&&i[a]===e)return u||a||0;return!u&&-1}},Pn={includes:On(!0),indexOf:On(!1)},xn=lt,Ln=yu,kn=Pn.indexOf,Nn=Ne,Un=su([].push),Rn=function(u,t){var e,n=Ln(u),r=0,i=[];for(e in n)!xn(Nn,e)&&xn(n,e)&&Un(i,e);for(;t.length>r;)xn(n,e=t[r++])&&(~kn(i,e)||Un(i,e));return i},jn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"].concat("length","prototype");En.f=Object.getOwnPropertyNames||function(u){return Rn(u,jn)};var Gn={};Gn.f=Object.getOwnPropertySymbols;var Mn=Su,qn=En,Hn=Gn,Jn=re,Kn=su([].concat),zn=Mn("Reflect","ownKeys")||function(u){var t=qn.f(Jn(u)),e=Hn.f;return e?Kn(t,e(u)):t},Yn=lt,Qn=zn,Vn=q,Wn=Zt,Xn=function(u,t,e){for(var n=Qn(t),r=Wn.f,i=Vn.f,o=0;o<n.length;o++){var a=n[o];Yn(u,a)||e&&Yn(e,a)||r(u,a,i(t,a))}},Zn=H,ur=Bu,tr=/#|\.prototype\./,er=function(u,t){var e=rr[nr(u)];return e==or||e!=ir&&(ur(t)?Zn(t):!!t)},nr=er.normalize=function(u){return String(u).replace(tr,".").toLowerCase()},rr=er.data={},ir=er.NATIVE="N",or=er.POLYFILL="P",ar=er,sr=M,cr=q.f,Dr=pe,fr=function(u,t,e,n){n||(n={});var r=n.enumerable,i=void 0!==n.name?n.name:t;return Cn(e)&&Fn(e,i,n),n.global?r?u[t]=e:An(t,e):(n.unsafe?u[t]&&(r=!0):delete u[t],r?u[t]=e:pn(u,t,e)),u},lr=rt,dr=Xn,Cr=ar,pr=K,Fr=Function.prototype,Ar=Fr.apply,Er=Fr.call,gr="object"==typeof Reflect&&Reflect.apply||(pr?Er.bind(Ar):function(){return Er.apply(Ar,arguments)}),mr=Bu,hr=String,yr=TypeError,Br=su,wr=re,vr=function(u){if("object"==typeof u||mr(u))return u;throw yr("Can't set "+hr(u)+" as a prototype")},_r=Object.setPrototypeOf||("__proto__"in{}?function(){var u,t=!1,e={};try{(u=Br(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(e,[]),t=e instanceof Array}catch(u){}return function(e,n){return wr(e),vr(n),t?u(e,n):e.__proto__=n,e}}():void 0),br=Zt.f,$r=Bu,Sr=vu,Tr=_r,Ir={};Ir[$t("toStringTag")]="z";var Or="[object z]"===String(Ir),Pr=Bu,xr=lu,Lr=$t("toStringTag"),kr=Object,Nr="Arguments"==xr(function(){return arguments}()),Ur=Or?xr:function(u){var t,e,n;return void 0===u?"Undefined":null===u?"Null":"string"==typeof(e=function(u,t){try{return u[t]}catch(u){}}(t=kr(u),Lr))?e:Nr?xr(t):"Object"==(n=xr(t))&&Pr(t.callee)?"Arguments":n},Rr=Ur,jr=String,Gr=function(u){if("Symbol"===Rr(u))throw TypeError("Cannot convert a Symbol value to a string");return jr(u)},Mr=vu,qr=pe,Hr=Error,Jr=su("".replace),Kr=String(Hr("zxcasd").stack),zr=/\n\s*at [^:]*:[^\n]*/,Yr=zr.test(Kr),Qr=eu,Vr=!H((function(){var u=Error("a");return!("stack"in u)||(Object.defineProperty(u,"stack",Qr(1,7)),7!==u.stack)})),Wr=Su,Xr=lt,Zr=pe,ui=Tu,ti=_r,ei=Xn,ni=function(u,t,e){e in u||br(u,e,{configurable:!0,get:function(){return t[e]},set:function(u){t[e]=u}})},ri=function(u,t,e){var n,r;return Tr&&$r(n=t.constructor)&&n!==e&&Sr(r=n.prototype)&&r!==e.prototype&&Tr(u,r),u},ii=function(u,t){return void 0===u?arguments.length<2?"":t:Gr(u)},oi=function(u,t){Mr(t)&&"cause"in t&&qr(u,"cause",t.cause)},ai=function(u,t){if(Yr&&"string"==typeof u&&!Hr.prepareStackTrace)for(;t--;)u=Jr(u,zr,"");return u},si=Vr,ci=J,Di=function(u,t){var e,n,r,i,o,a=u.target,s=u.global,c=u.stat;if(e=s?sr:c?sr[a]||lr(a,{}):(sr[a]||{}).prototype)for(n in t){if(i=t[n],r=u.dontCallGetSet?(o=cr(e,n))&&o.value:e[n],!Cr(s?n:a+(c?".":"#")+n,u.forced)&&void 0!==r){if(typeof i==typeof r)continue;dr(i,r)}(u.sham||r&&r.sham)&&Dr(i,"sham",!0),fr(e,n,i,u)}},fi=gr,li=function(u,t,e,n){var r="stackTraceLimit",i=n?2:1,o=u.split("."),a=o[o.length-1],s=Wr.apply(null,o);if(s){var c=s.prototype;if(Xr(c,"cause")&&delete c.cause,!e)return s;var D=Wr("Error"),f=t((function(u,t){var e=ii(n?t:u,void 0),r=n?new s(u):new s;return void 0!==e&&Zr(r,"message",e),si&&Zr(r,"stack",ai(r.stack,2)),this&&ui(c,this)&&ri(r,this,f),arguments.length>i&&oi(r,arguments[i]),r}));f.prototype=c,"Error"!==a?ti?ti(f,D):ei(f,D,{name:!0}):ci&&r in s&&(ni(f,s,r),ni(f,s,"prepareStackTrace")),ei(f,s);try{c.name!==a&&Zr(c,"name",a),c.constructor=f}catch(u){}return f}},di=M.WebAssembly,Ci=7!==Error("e",{cause:7}).cause,pi=function(u,t){var e={};e[u]=li(u,t,Ci),Di({global:!0,constructor:!0,arity:1,forced:Ci},e)},Fi=function(u,t){if(di&&di[u]){var e={};e[u]=li("WebAssembly."+u,t,Ci),Di({target:"WebAssembly",stat:!0,constructor:!0,arity:1,forced:Ci},e)}};pi("Error",(function(u){return function(t){return fi(u,this,arguments)}})),pi("EvalError",(function(u){return function(t){return fi(u,this,arguments)}})),pi("RangeError",(function(u){return function(t){return fi(u,this,arguments)}})),pi("ReferenceError",(function(u){return function(t){return fi(u,this,arguments)}})),pi("SyntaxError",(function(u){return function(t){return fi(u,this,arguments)}})),pi("TypeError",(function(u){return function(t){return fi(u,this,arguments)}})),pi("URIError",(function(u){return function(t){return fi(u,this,arguments)}})),Fi("CompileError",(function(u){return function(t){return fi(u,this,arguments)}})),Fi("LinkError",(function(u){return function(t){return fi(u,this,arguments)}})),Fi("RuntimeError",(function(u){return function(t){return fi(u,this,arguments)}}));function Ai(u,t=!0){return t?u.toLocaleString("zh-CN",{hour12:!1}):u.toLocaleString("zh-CN",{hour12:!1,hour:"numeric",minute:"numeric",second:"numeric"})}function Ei(u="info"){const t=["error","warn","info","verbose","debug"],e=t.indexOf(u);return e>0?t.slice(0,e+1):t}function gi(u){return s.resolve(process.cwd(),u)}class mi{static pushValue="";month=T().getMonth()+1;errorFile=gi(`./logs/bt_error-${this.month}.log`);logFile=gi(`./logs/bt_combined-${this.month}.log`);noFile=!1;constructor(u={console:"info",file:"info",push:"info"},t="default"){this.options=u,this.name=t,this.consoleLeval=Ei(this.options.console),this.fileLeval=Ei(this.options.file),this.pushLeval=Ei(this.options.push),this.noFile=!0,this.noFile||this.createLogFile()}log({level:u},t){const e=T(),n=`[${u} ${Ai(e,!1)}] ${t}\n`,r=["error","warn"].includes(u);this.consoleLeval.includes(u)&&this.Conslole(n,r),!this.noFile&&this.fileLeval.includes(u)&&this.File(`[${u} ${Ai(e,!0)}] ${t}\n`,r),this.pushLeval.includes(u)&&this.Push(n)}error(u){this.log({level:"error"},u)}warn(u){this.log({level:"warn"},u)}info(u){this.log({level:"info"},u)}verbose(u){this.log({level:"verbose"},u)}debug(u){this.log({level:"debug"},u)}Conslole(u,t){t?process.stderr.write(u):process.stdout.write(u)}File(u,t){t&&c.appendFileSync(this.errorFile,u,"utf-8"),c.appendFileSync(this.logFile,u,"utf-8")}Push(u){mi.pushValue+=u}createLogFile(){const u=gi("./logs");c.existsSync(u)||c.mkdirSync(u)}}const hi=new mi({console:"debug",file:"debug",push:"debug"});function yi(u){try{const t=e.unzipSync(Buffer.from(u,"base64")).toString();try{return decodeURIComponent(function(u){return u.replace(/\\u([\d\w]{4})/gi,((u,t)=>String.fromCodePoint(parseInt(t,16))))}(t))}catch(u){return unescape(t)}}catch(u){throw new Error("Error: 当前字符串不能被Gzip解压")}}class Bi{static configFileName=function(){const u=".json",{BILITOOLS_FILE_NAME:t}=process.env;return t?t.endsWith(u)?t:`${t}.json`:"cat_bili_config"+u}();static isQingLongPanel=!0}var wi={Space_Separator:/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,ID_Start:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,ID_Continue:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/},vi={isSpaceSeparator:u=>"string"==typeof u&&wi.Space_Separator.test(u),isIdStartChar:u=>"string"==typeof u&&(u>="a"&&u<="z"||u>="A"&&u<="Z"||"$"===u||"_"===u||wi.ID_Start.test(u)),isIdContinueChar:u=>"string"==typeof u&&(u>="a"&&u<="z"||u>="A"&&u<="Z"||u>="0"&&u<="9"||"$"===u||"_"===u||"‌"===u||"‍"===u||wi.ID_Continue.test(u)),isDigit:u=>"string"==typeof u&&/[0-9]/.test(u),isHexDigit:u=>"string"==typeof u&&/[0-9A-Fa-f]/.test(u)};let _i,bi,$i,Si,Ti,Ii,Oi,Pi,xi;function Li(u,t,e){const n=u[t];if(null!=n&&"object"==typeof n)for(const u in n){const t=Li(n,u,e);void 0===t?delete n[u]:n[u]=t}return e.call(u,t,n)}let ki,Ni,Ui,Ri,ji;function Gi(){for(ki="default",Ni="",Ui=!1,Ri=1;;){ji=Mi();const u=Hi[ki]();if(u)return u}}function Mi(){if(_i[Si])return String.fromCodePoint(_i.codePointAt(Si))}function qi(){const u=Mi();return"\n"===u?(Ti++,Ii=0):u?Ii+=u.length:Ii++,u&&(Si+=u.length),u}const Hi={default(){switch(ji){case"\t":case"\v":case"\f":case" ":case" ":case"\ufeff":case"\n":case"\r":case"\u2028":case"\u2029":return void qi();case"/":return qi(),void(ki="comment");case void 0:return qi(),Ji("eof")}if(!vi.isSpaceSeparator(ji))return Hi[bi]();qi()},comment(){switch(ji){case"*":return qi(),void(ki="multiLineComment");case"/":return qi(),void(ki="singleLineComment")}throw Wi(qi())},multiLineComment(){switch(ji){case"*":return qi(),void(ki="multiLineCommentAsterisk");case void 0:throw Wi(qi())}qi()},multiLineCommentAsterisk(){switch(ji){case"*":return void qi();case"/":return qi(),void(ki="default");case void 0:throw Wi(qi())}qi(),ki="multiLineComment"},singleLineComment(){switch(ji){case"\n":case"\r":case"\u2028":case"\u2029":return qi(),void(ki="default");case void 0:return qi(),Ji("eof")}qi()},value(){switch(ji){case"{":case"[":return Ji("punctuator",qi());case"n":return qi(),Ki("ull"),Ji("null",null);case"t":return qi(),Ki("rue"),Ji("boolean",!0);case"f":return qi(),Ki("alse"),Ji("boolean",!1);case"-":case"+":return"-"===qi()&&(Ri=-1),void(ki="sign");case".":return Ni=qi(),void(ki="decimalPointLeading");case"0":return Ni=qi(),void(ki="zero");case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return Ni=qi(),void(ki="decimalInteger");case"I":return qi(),Ki("nfinity"),Ji("numeric",1/0);case"N":return qi(),Ki("aN"),Ji("numeric",NaN);case'"':case"'":return Ui='"'===qi(),Ni="",void(ki="string")}throw Wi(qi())},identifierNameStartEscape(){if("u"!==ji)throw Wi(qi());qi();const u=zi();switch(u){case"$":case"_":break;default:if(!vi.isIdStartChar(u))throw Zi()}Ni+=u,ki="identifierName"},identifierName(){switch(ji){case"$":case"_":case"‌":case"‍":return void(Ni+=qi());case"\\":return qi(),void(ki="identifierNameEscape")}if(!vi.isIdContinueChar(ji))return Ji("identifier",Ni);Ni+=qi()},identifierNameEscape(){if("u"!==ji)throw Wi(qi());qi();const u=zi();switch(u){case"$":case"_":case"‌":case"‍":break;default:if(!vi.isIdContinueChar(u))throw Zi()}Ni+=u,ki="identifierName"},sign(){switch(ji){case".":return Ni=qi(),void(ki="decimalPointLeading");case"0":return Ni=qi(),void(ki="zero");case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return Ni=qi(),void(ki="decimalInteger");case"I":return qi(),Ki("nfinity"),Ji("numeric",Ri*(1/0));case"N":return qi(),Ki("aN"),Ji("numeric",NaN)}throw Wi(qi())},zero(){switch(ji){case".":return Ni+=qi(),void(ki="decimalPoint");case"e":case"E":return Ni+=qi(),void(ki="decimalExponent");case"x":case"X":return Ni+=qi(),void(ki="hexadecimal")}return Ji("numeric",0*Ri)},decimalInteger(){switch(ji){case".":return Ni+=qi(),void(ki="decimalPoint");case"e":case"E":return Ni+=qi(),void(ki="decimalExponent")}if(!vi.isDigit(ji))return Ji("numeric",Ri*Number(Ni));Ni+=qi()},decimalPointLeading(){if(vi.isDigit(ji))return Ni+=qi(),void(ki="decimalFraction");throw Wi(qi())},decimalPoint(){switch(ji){case"e":case"E":return Ni+=qi(),void(ki="decimalExponent")}return vi.isDigit(ji)?(Ni+=qi(),void(ki="decimalFraction")):Ji("numeric",Ri*Number(Ni))},decimalFraction(){switch(ji){case"e":case"E":return Ni+=qi(),void(ki="decimalExponent")}if(!vi.isDigit(ji))return Ji("numeric",Ri*Number(Ni));Ni+=qi()},decimalExponent(){switch(ji){case"+":case"-":return Ni+=qi(),void(ki="decimalExponentSign")}if(vi.isDigit(ji))return Ni+=qi(),void(ki="decimalExponentInteger");throw Wi(qi())},decimalExponentSign(){if(vi.isDigit(ji))return Ni+=qi(),void(ki="decimalExponentInteger");throw Wi(qi())},decimalExponentInteger(){if(!vi.isDigit(ji))return Ji("numeric",Ri*Number(Ni));Ni+=qi()},hexadecimal(){if(vi.isHexDigit(ji))return Ni+=qi(),void(ki="hexadecimalInteger");throw Wi(qi())},hexadecimalInteger(){if(!vi.isHexDigit(ji))return Ji("numeric",Ri*Number(Ni));Ni+=qi()},string(){switch(ji){case"\\":return qi(),void(Ni+=function(){switch(Mi()){case"b":return qi(),"\b";case"f":return qi(),"\f";case"n":return qi(),"\n";case"r":return qi(),"\r";case"t":return qi(),"\t";case"v":return qi(),"\v";case"0":if(qi(),vi.isDigit(Mi()))throw Wi(qi());return"\0";case"x":return qi(),function(){let u="",t=Mi();if(!vi.isHexDigit(t))throw Wi(qi());if(u+=qi(),t=Mi(),!vi.isHexDigit(t))throw Wi(qi());return u+=qi(),String.fromCodePoint(parseInt(u,16))}();case"u":return qi(),zi();case"\n":case"\u2028":case"\u2029":return qi(),"";case"\r":return qi(),"\n"===Mi()&&qi(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case void 0:throw Wi(qi())}return qi()}());case'"':return Ui?(qi(),Ji("string",Ni)):void(Ni+=qi());case"'":return Ui?void(Ni+=qi()):(qi(),Ji("string",Ni));case"\n":case"\r":throw Wi(qi());case"\u2028":case"\u2029":!function(u){console.warn(`JSON5: '${uo(u)}' in strings is not valid ECMAScript; consider escaping`)}(ji);break;case void 0:throw Wi(qi())}Ni+=qi()},start(){switch(ji){case"{":case"[":return Ji("punctuator",qi())}ki="value"},beforePropertyName(){switch(ji){case"$":case"_":return Ni=qi(),void(ki="identifierName");case"\\":return qi(),void(ki="identifierNameStartEscape");case"}":return Ji("punctuator",qi());case'"':case"'":return Ui='"'===qi(),void(ki="string")}if(vi.isIdStartChar(ji))return Ni+=qi(),void(ki="identifierName");throw Wi(qi())},afterPropertyName(){if(":"===ji)return Ji("punctuator",qi());throw Wi(qi())},beforePropertyValue(){ki="value"},afterPropertyValue(){switch(ji){case",":case"}":return Ji("punctuator",qi())}throw Wi(qi())},beforeArrayValue(){if("]"===ji)return Ji("punctuator",qi());ki="value"},afterArrayValue(){switch(ji){case",":case"]":return Ji("punctuator",qi())}throw Wi(qi())},end(){throw Wi(qi())}};function Ji(u,t){return{type:u,value:t,line:Ti,column:Ii}}function Ki(u){for(const t of u){if(Mi()!==t)throw Wi(qi());qi()}}function zi(){let u="",t=4;for(;t-- >0;){const t=Mi();if(!vi.isHexDigit(t))throw Wi(qi());u+=qi()}return String.fromCodePoint(parseInt(u,16))}const Yi={start(){if("eof"===Oi.type)throw Xi();Qi()},beforePropertyName(){switch(Oi.type){case"identifier":case"string":return Pi=Oi.value,void(bi="afterPropertyName");case"punctuator":return void Vi();case"eof":throw Xi()}},afterPropertyName(){if("eof"===Oi.type)throw Xi();bi="beforePropertyValue"},beforePropertyValue(){if("eof"===Oi.type)throw Xi();Qi()},beforeArrayValue(){if("eof"===Oi.type)throw Xi();"punctuator"!==Oi.type||"]"!==Oi.value?Qi():Vi()},afterPropertyValue(){if("eof"===Oi.type)throw Xi();switch(Oi.value){case",":return void(bi="beforePropertyName");case"}":Vi()}},afterArrayValue(){if("eof"===Oi.type)throw Xi();switch(Oi.value){case",":return void(bi="beforeArrayValue");case"]":Vi()}},end(){}};function Qi(){let u;switch(Oi.type){case"punctuator":switch(Oi.value){case"{":u={};break;case"[":u=[]}break;case"null":case"boolean":case"numeric":case"string":u=Oi.value}if(void 0===xi)xi=u;else{const t=$i[$i.length-1];Array.isArray(t)?t.push(u):t[Pi]=u}if(null!==u&&"object"==typeof u)$i.push(u),bi=Array.isArray(u)?"beforeArrayValue":"beforePropertyName";else{const u=$i[$i.length-1];bi=null==u?"end":Array.isArray(u)?"afterArrayValue":"afterPropertyValue"}}function Vi(){$i.pop();const u=$i[$i.length-1];bi=null==u?"end":Array.isArray(u)?"afterArrayValue":"afterPropertyValue"}function Wi(u){return to(void 0===u?`JSON5: invalid end of input at ${Ti}:${Ii}`:`JSON5: invalid character '${uo(u)}' at ${Ti}:${Ii}`)}function Xi(){return to(`JSON5: invalid end of input at ${Ti}:${Ii}`)}function Zi(){return Ii-=5,to(`JSON5: invalid identifier character at ${Ti}:${Ii}`)}function uo(u){const t={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(t[u])return t[u];if(u<" "){const t=u.charCodeAt(0).toString(16);return"\\x"+("00"+t).substring(t.length)}return u}function to(u){const t=new SyntaxError(u);return t.lineNumber=Ti,t.columnNumber=Ii,t}const eo={parse:function(u,t){_i=String(u),bi="start",$i=[],Si=0,Ti=1,Ii=0,Oi=void 0,Pi=void 0,xi=void 0;do{Oi=Gi(),Yi[bi]()}while("eof"!==Oi.type);return"function"==typeof t?Li({"":xi},"",t):xi},stringify:function(u,t,e){const n=[];let r,i,o,a="",s="";if(null==t||"object"!=typeof t||Array.isArray(t)||(e=t.space,o=t.quote,t=t.replacer),"function"==typeof t)i=t;else if(Array.isArray(t)){r=[];for(const u of t){let t;"string"==typeof u?t=u:("number"==typeof u||u instanceof String||u instanceof Number)&&(t=String(u)),void 0!==t&&r.indexOf(t)<0&&r.push(t)}}return e instanceof Number?e=Number(e):e instanceof String&&(e=String(e)),"number"==typeof e?e>0&&(e=Math.min(10,Math.floor(e)),s="          ".substr(0,e)):"string"==typeof e&&(s=e.substr(0,10)),c("",{"":u});function c(u,t){let e=t[u];switch(null!=e&&("function"==typeof e.toJSON5?e=e.toJSON5(u):"function"==typeof e.toJSON&&(e=e.toJSON(u))),i&&(e=i.call(t,u,e)),e instanceof Number?e=Number(e):e instanceof String?e=String(e):e instanceof Boolean&&(e=e.valueOf()),e){case null:return"null";case!0:return"true";case!1:return"false"}return"string"==typeof e?D(e):"number"==typeof e?String(e):"object"==typeof e?Array.isArray(e)?function(u){if(n.indexOf(u)>=0)throw TypeError("Converting circular structure to JSON5");n.push(u);let t=a;a+=s;let e,r=[];for(let t=0;t<u.length;t++){const e=c(String(t),u);r.push(void 0!==e?e:"null")}if(0===r.length)e="[]";else if(""===s){e="["+r.join(",")+"]"}else{let u=",\n"+a,n=r.join(u);e="[\n"+a+n+",\n"+t+"]"}return n.pop(),a=t,e}(e):function(u){if(n.indexOf(u)>=0)throw TypeError("Converting circular structure to JSON5");n.push(u);let t=a;a+=s;let e,i=r||Object.keys(u),o=[];for(const t of i){const e=c(t,u);if(void 0!==e){let u=f(t)+":";""!==s&&(u+=" "),u+=e,o.push(u)}}if(0===o.length)e="{}";else{let u;if(""===s)u=o.join(","),e="{"+u+"}";else{let n=",\n"+a;u=o.join(n),e="{\n"+a+u+",\n"+t+"}"}}return n.pop(),a=t,e}(e):void 0}function D(u){const t={"'":.1,'"':.2},e={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};let n="";for(let r=0;r<u.length;r++){const i=u[r];switch(i){case"'":case'"':t[i]++,n+=i;continue;case"\0":if(vi.isDigit(u[r+1])){n+="\\x00";continue}}if(e[i])n+=e[i];else if(i<" "){let u=i.charCodeAt(0).toString(16);n+="\\x"+("00"+u).substring(u.length)}else n+=i}const r=o||Object.keys(t).reduce(((u,e)=>t[u]<t[e]?u:e));return n=n.replace(new RegExp(r,"g"),e[r]),r+n+r}function f(u){if(0===u.length)return D(u);const t=String.fromCodePoint(u.codePointAt(0));if(!vi.isIdStartChar(t))return D(u);for(let e=t.length;e<u.length;e++)if(!vi.isIdContinueChar(String.fromCodePoint(u.codePointAt(e))))return D(u);return u}}};var no=eo;const ro=no||Object.freeze({__proto__:null,default:no});function io(u){try{let e;if((t.existsSync(u)||t.existsSync(u+="5"))&&(e=t.readFileSync(u,"utf-8")),!e)return;return hi.verbose(`读取配置文件 ${u}`),ro.parse(e)}catch(u){!function(u){if(!$(u))return;if(u.includes("SyntaxError: JSON5"))throw hi.error(u),new SyntaxError("配置文件存在，但是无法解析！可能 JSON5 格式不正确！");throw new Error(u)}(u.message)}}const oo=u=>s.resolve(process.cwd(),u),ao=u=>s.resolve(__dirname,"../",u),so=Array.from(new Set([oo("./config/config.dev.json"),oo(`./config/${Bi.configFileName}`),oo(`./${Bi.configFileName}`),ao(`./config/${Bi.configFileName}`),ao(`./${Bi.configFileName}`)])),co=["./config.json",oo("./config/config.json")];function Do(u){let t;if(t=Array.isArray(u)?u:u.account.filter((u=>u.cookie)),0!==t.length)return function(u){const t=process.argv.find((u=>u.includes("--item")||u.includes("-i")||u.includes("-I")));if(!t)return u[0];const e=Number(t.split("=")[1])-1;return!e||e>=u.length||e<0?(hi.warn("似乎想要指定一个不存在的用户，我们将指定第一个用户"),u[0]):u[e]}(t)}function fo(){if(globalThis.BILITOOLS_CONFIG)return globalThis.BILITOOLS_CONFIG;so.splice(0,1,...co);for(let u=0;u<so.length;u++){const t=io(so[u]);if(t)return t}return(()=>{const{BILITOOLS_CONFIG:u,BILI_SCF_CONFIG:t,BILI_CONFIG:e}=process.env,n=u||t||e;if(n)try{return ro.parse(yi(n))}catch{throw new Error("环境中的配置不是有效的 JSON 字符串！")}})()}function lo(u){if(!u)throw new Error("获取配置失败！未找到配置文件！");if(function(u){if(Array.isArray(u))return!0;return Boolean(u.account&&u.account.length)}(u)){const t=Do(u);if(t)return t}if(!u.cookie)throw new Error("配置文件中没有 cookie！");return u}function Co(u){return u?u.split("; ").map((u=>u.split("="))):[]}function po(u,t){return u?t&&0!==t.length?function(u){const t=Object.keys(u).reduce(((t,e)=>t+`${e}=${u[e]}; `),"");return t.substring(0,t.length-2||0)}(function(u,t){const e=Co(null==t?void 0:t[0]).filter((u=>2===u.length)),n=Co(u).concat(e).filter((u=>2===u.length)),r={};for(const u of n)r[u[0]]?r[u[0]]=u[1]:Object.defineProperty(r,u[0],{value:u[1],enumerable:!0,writable:!0});return r}(u,t)):u:""}function Fo(u,t){if(!u)return null;const e=`(?:^|)${t}=([^;]*)(?:;|$)`,n=u.match(e);return n?n[1]:null}const Ao={cookie:"",message:{email:{host:"smtp.163.com",port:465},pushplusToken:process.env.PUSHPLUS_TOKEN,api:void 0},function:{silver2Coin:!0,liveSignTask:!0,addCoins:!0,mangaSign:!1,shareAndWatch:!0,supGroupSign:!1,liveSendMessage:!1,taskReward:!0,charging:!1,getVipPrivilege:!1,giveGift:!1,matchGame:!1,liveLottery:!1,liveRedPack:!1,liveIntimacy:!1},apiDelay:[2,6],userAgent:"",dailyRunTime:"17:30:00-23:40:00",targetLevel:void 0,stayCoins:void 0,targetCoins:void 0,customizeUp:void 0,giftUp:void 0,coinRetryNum:void 0,chargeUpId:void 0,chargePresetTime:void 0,matchCoins:void 0,matchSelection:void 0,matchDiff:void 0,match:{coins:5,selection:1,diff:0},charge:{mid:0,presetTime:31},gift:{mids:[]},coin:{customizeUp:[],retryNum:4,targetLevel:6,stayCoins:0,targetCoins:5},sls:{name:"",description:"",region:"ap-chengdu",dailyRunTime:"17:30:00-23:40:00"},lottery:{excludeAward:["舰","船","航海","代金券","优惠券","自拍","照","写真","图","提督","车车一局","再来一局","游戏道具"],includeAward:["谢"],blackUid:[65566781,1277481241,1643654862,603676925],isMoveTag:!0,moveTag:"天选时刻",pageNum:2,actFollowMsg:"read",scanFollow:void 0,skipNeedFollow:!1},redPack:{},intimacy:{liveSendMessage:!0,liveShare:!0,liveLike:!0,whiteList:[],blackList:[]},BILIJCT:"",USERID:0};function Eo(){return L(Ao,!0)}function go(u){return function(u){!function(u){u.BILIJCT=function(u){return Fo(u,"bili_jct")||""}(u.cookie),u.USERID=function(u){return Number(Fo(u,"DedeUserID"))||0}(u.cookie)}(u);const{coin:t,gift:e,charge:n}=u;S(u.apiDelay)?u.apiDelay=R(u.apiDelay):u.apiDelay=[Number(u.apiDelay)];t.customizeUp=R(t.customizeUp),e.mids=R(e.mids),0===e.mids.length&&(e.mids=t.customizeUp);n.mid||(n.mid=u.USERID);return u}(function(u){return Object.keys(mo).forEach((t=>{if(void 0!==u[t]){const[e,n]=mo[t];u[e]=u[e]||{},u[e][n]=u[t]}delete u[t]})),u}(k(Eo(),u)))}const mo={targetLevel:["coin","targetLevel"],stayCoins:["coin","stayCoins"],targetCoins:["coin","targetCoins"],customizeUp:["coin","customizeUp"],coinRetryNum:["coin","retryNum"],giftUp:["gift","mids"],chargeUpId:["charge","mid"],chargePresetTime:["charge","presetTime"],matchCoins:["match","coins"],matchSelection:["match","selection"],matchDiff:["match","diff"]};class ho{constructor(u){this.COOKIE=u.cookie,this.BILIJCT=u.BILIJCT,this.USERID=u.USERID,this.USER_AGENT=u.userAgent,this.BILI_API_DELAY=u.apiDelay;const t=u.message;this.MESSAGE_API=t.api,this.PUSHPLUS_TOKEN=t.pushplusToken;const e=u.coin;this.BILI_CUSTOMIZE_UP=e.customizeUp,this.BILI_COIN_RETRY_NUM=e.retryNum,this.BILI_TARGET_LEVEL=e.targetLevel,this.BILI_STAY_COINS=e.stayCoins,this.BILI_TARGET_COINS=e.targetCoins;const n=u.gift;this.BILI_GIFT_UP=n.mids;const r=u.charge;this.CHARGE_ID=r.mid,this.CHARGE_PRESET_TIME=r.presetTime;const i=u.match;this.MATCH_COINS=i.coins,this.MATCH_SELECTION=i.selection,this.MATCH_DIFF=i.diff}}let yo;const Bo=new Proxy({},{get:(u,t)=>(yo||vo(),Reflect.get(yo,t)),set:(u,t,e)=>"config"===t&&e?(vo(e),!0):Reflect.set(yo,t,e)});let wo=null;function vo(u){u||(u=lo(fo()));const t=go(u);yo={...new ho(lo(t)),...t},wo=class extends class{static money=0;static coinsTask=5;static share=!1;static watch=!1;static currentStartFun=0;static bCoinCouponBalance=0;static vipType=0;static userLevel=0}{},wo.coinsTask=yo.BILI_TARGET_COINS}const _o=(u,t)=>{const{isTransformResponse:e,isReturnNativeResponse:n}=t;if(n)return u;if(!1===e)return u.body;const{body:r}=u;if(t.isJsonp&&$(r))return function(u){const t=u.replace(/^\w+\(/,"").replace(/\)$/,"");return JSON.parse(t)}(r);try{if($(r)&&r.startsWith("{"))return JSON.parse(r)}catch{}return r};class bo{name="VGot";constructor(u){u.baseURL&&(u.prefixUrl=u.baseURL),this.options=u,this.gotInstance=f.default.extend(u,{hooks:{afterResponse:[u=>{const{requestOptions:t}=u.request.options;var e;null!=t&&t.withBiliCookie&&(Bo.COOKIE=po(Bo.COOKIE,(null===(e=u.headers)||void 0===e?void 0:e["set-cookie"])||[]));return u}]}})}request(u){const{requestOptions:t={},headers:e={}}=this.options;return u.requestOptions=Object.assign({},t,u.requestOptions),u.headers=function(u={},t={}){function e(u){return Object.keys(u).reduce(((t,e)=>(t[e.toLowerCase()]=u[e],t)),{})}return Object.assign({},e(u),e(t))}(e,u.headers),t.withBiliCookie&&(u.headers.Cookie=Bo.COOKIE),t.retry&&(u.retry=t.retry),u=function(u){$(u.url)||(u.url=u.url.toString()),b(u.params)&&!$(u.searchParams)&&(u.searchParams={...u.searchParams,...u.params});const t=u.headers["content-type"],e=null==t?void 0:t.startsWith("application/x-www-form-urlencoded");function n(t){u.agent||(u.agent={}),u.agent[t]=u[`${t}Agent`]}return b(u.data)&&(e?u.body=N(u.data):u.json=u.data),$(u.data)&&e&&(u.body=u.data),u.httpAgent&&n("http"),u.httpsAgent&&n("https"),u.url&&u.url.startsWith("/")&&(u.url=u.url.substring(1)),u}(u),new Promise(((t,e)=>{this.gotInstance(u).then((n=>{{"function"!=typeof _o;try{const e=_o(n,u.requestOptions);t(e)}catch(u){e(u||new Error("请求错误!"))}}})).catch((u=>{e(u)}))}))}get(u,t){return $(u)?this.request({...t,method:"GET",url:u}):this.request({...u,method:"GET"})}post(u,t,e){return $(u)?this.request({...e,method:"POST",url:u,data:t}):this.request({...u,method:"POST"})}put(u,t,e){return this.request({...e,method:"PUT",url:u,data:t})}delete(u,t,e){return this.request({...e,method:"DELETE",url:u,data:t})}patch(u,t,e){return this.request({...e,method:"PATCH",url:u,data:t})}}function $o(u){return new bo(k({timeout:1e4,headers:{"content-type":B["content-type"],"user-agent":B["user-agent"],"accept-language":B["accept-language"],"accept-encoding":B["accept-encoding"]},requestOptions:{isTransformResponse:!0,ignoreCancelToken:!0,withBiliCookie:!0}},u||{}))}const So=$o({requestOptions:{withBiliCookie:!1}}),To=$o();async function Io(){let u="v0.5.1";u.includes(".")?hi.info("当前版本【v0.5.1】"):u=void 0;try{if(u||(u="v"+(function(){try{return require("../../package.json").version}catch{}}()||function(){try{return c.readFileSync(s.resolve(__dirname,"../version.txt"),"utf8").trim()}catch{}}()),hi.info(`当前版本【${u}】`)),!u)return;const t=await async function(){const u={timeout:6e3};try{return(await Promise.any([So.get("https://api.github.com/repos/catlair/BiliTools/releases/latest",u),So.get("https://gitee.com/api/v5/repos/catlair/BiliTools/releases/latest",u)])).tag_name}catch(u){return}}();t&&t!==u&&hi.info(`可更新：最新版本【${t}】`)}catch{}}function Oo(u){const t=function(){const u=Bo.function;return u.addCoins||u.shareAndWatch||(u.taskReward=!1),u.liveIntimacy&&(u.liveSendMessage=!1),u}();return u.map((u=>t[u.name]?u:null)).filter((u=>u))}function Po(u,t){const e=function(u,t){if(u&&t)return O(u,t);if(u)return u;const e=Bo.BILI_API_DELAY;if(1===e.length)return 1e3*e[0];return 1e3*O(e[0]||2,e[1]||6)}(u,t);return new Promise((u=>{setTimeout((()=>{u(e)}),e)}))}let xo;function Lo(){const u=Bo.message||{};xo={},["GOBOT_URL","GOBOT_TOKEN","GOBOT_QQ","SCKEY","QQ_SKEY","QQ_MODE","BARK_PUSH","BARK_SOUND","BARK_GROUP","TG_BOT_TOKEN","TG_USER_ID","TG_PROXY_AUTH","TG_PROXY_HOST","TG_PROXY_PORT","TG_API_HOST","DD_BOT_TOKEN","DD_BOT_SECRET","QYWX_KEY","QYWX_AM","IGOT_PUSH_KEY","PUSH_PLUS_TOKEN","PUSH_PLUS_USER"].forEach((t=>{const e=u[(n=t,n.toLowerCase().replace(/_(\w)/g,((u,t)=>t.toUpperCase())))]||u[t]||process.env[t];var n;e&&(xo[t]=e)})),Bo.PUSHPLUS_TOKEN&&(xo.PUSH_PLUS_TOKEN=Bo.PUSHPLUS_TOKEN),function(){xo.PUSH_KEY&&(ko=xo.PUSH_KEY);xo.QQ_SKEY&&(Zo=xo.QQ_SKEY);xo.QQ_MODE&&(ua=xo.QQ_MODE);xo.BARK_PUSH?(No=xo.BARK_PUSH.indexOf("https")>-1||xo.BARK_PUSH.indexOf("http")>-1?xo.BARK_PUSH:`https://api.day.app/${xo.BARK_PUSH}`,xo.BARK_SOUND&&(Uo=xo.BARK_SOUND),xo.BARK_GROUP&&(Ro=xo.BARK_GROUP)):No&&-1===No.indexOf("https")&&-1===No.indexOf("http")&&(No=`https://api.day.app/${No}`);xo.TG_BOT_TOKEN&&(jo=xo.TG_BOT_TOKEN);xo.TG_USER_ID&&(Go=xo.TG_USER_ID);xo.TG_PROXY_AUTH&&(Ho=xo.TG_PROXY_AUTH);xo.TG_PROXY_HOST&&(Mo=xo.TG_PROXY_HOST);xo.TG_PROXY_PORT&&(qo=xo.TG_PROXY_PORT);xo.TG_API_HOST&&(Jo=xo.TG_API_HOST);xo.DD_BOT_TOKEN&&(Ko=xo.DD_BOT_TOKEN,xo.DD_BOT_SECRET&&(zo=xo.DD_BOT_SECRET));xo.QYWX_KEY&&(Yo=xo.QYWX_KEY);xo.QYWX_AM&&(Qo=xo.QYWX_AM);xo.IGOT_PUSH_KEY&&(Vo=xo.IGOT_PUSH_KEY);xo.PUSH_PLUS_TOKEN&&(Wo=xo.PUSH_PLUS_TOKEN);xo.PUSH_PLUS_USER&&(Xo=xo.PUSH_PLUS_USER)}()}process.env.IS_LOCAL="true",async function(){const{dailyTasks:u}=await Promise.resolve().then((function(){return js}));await Io(),await u()}();let ko="",No="",Uo="",Ro="QingLong",jo="",Go="",Mo="",qo="",Ho="",Jo="api.telegram.org",Ko="",zo="",Yo="",Qo="",Vo="",Wo="",Xo="",Zo="",ua="";async function ta(u,t){var e;const n=null===(e=Bo.message)||void 0===e?void 0:e.email;if(!(n&&n.pass&&n.from&&n.host))return;const r=Number(n.port)||465,i=D.createTransport({host:n.host,port:r,secure:465===r,auth:{user:n.from,pass:n.pass}}),o=await i.sendMail({from:`${u} <${n.from}>`,to:n.to,subject:u,headers:{"Content-Type":"text/plain; charset=utf-8"},text:t.replace(/\n/g,"\r\n")});hi.info(`邮件消息已发送: ${o.messageId}`)}async function ea(u,t){try{const e=Bo.MESSAGE_API;if(!e)return;const n=e.replace("{title}",u).replace("{text}",t);await So.get(n)}catch(u){hi.info(`自定义接口消息发送失败: ${u}`),hi.error(u)}}function na(u,t,e=2100){return new Promise((n=>{if(ko){t=t.replace(/[\n\r]/g,"\n\n");const r={url:ko.includes("SCT")?`https://sctapi.ftqq.com/${ko}.send`:`https://sc.ftqq.com/${ko}.send`,params:`text=${u}&desp=${t}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};setTimeout((()=>{So.post(r).then((u=>{0===u.errno||0===u.data.errno?hi.info("server酱发送通知消息成功🎉"):1024===u.errno?hi.info(`server酱发送通知消息异常: ${u.errmsg}`):hi.info(`server酱发送通知消息异常\n${JSON.stringify(u)}`)})).catch((u=>{hi.info("发送通知调用API失败！！"),hi.info(u)})).finally((()=>{n("")}))}),e)}else n("")}))}function ra(u,t){return new Promise((e=>{if(Zo){const n={url:`https://push.xuthus.cc/${ua}/${Zo}`,headers:{"Content-Type":"application/json"},data:{},params:{}};u=u.replace(/京豆/g,"豆豆"),t=(t=(t=t.replace(/京豆/g,"")).replace(/🐶/g,"")).replace(/红包/g,"H包"),"email"===ua?n.data={t:u,c:t}:n.params=`${u}\n\n${t}`;const r=function(u){switch(u){case"send":return"个人";case"group":return"QQ群";case"wx":return"微信";case"ww":return"企业微信";case"email":return"邮件";default:return"未知方式"}};So.post(n).then((u=>{200===u.code?hi.info(`酷推发送${r(ua)}通知消息成功🎉`):400===u.code?hi.info(`QQ酷推(Cool Push)发送${r(ua)}推送失败：${u.msg}`):503===u.code?hi.info(`QQ酷推出错，${u.message}：${u.data}`):hi.info(`酷推推送异常: ${JSON.stringify(u)}`)})).catch((u=>{hi.info(`发送${r(ua)}通知调用API失败！！`),hi.info(u)})).finally((()=>{e("")}))}else e("")}))}function ia(u,t,e={}){return new Promise((n=>{if(No){const r={url:`${No}/${encodeURIComponent(u)}/${encodeURIComponent(t)}?sound=${Uo}&group=${Ro}&${N(e)}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};So.get(r).then((u=>{200===u.code?hi.info("Bark APP发送通知消息成功🎉"):hi.info(`Bark APP发送通失败：${u.message}`)})).catch((u=>{hi.info("Bark APP发送通知调用API失败！！"),hi.error(u)})).finally((()=>{n("")}))}n("")}))}function oa(u,t){return new Promise((async e=>{if(jo&&Go){const n={url:`https://${Jo}/bot${jo}/sendMessage`,data:`chat_id=${Go}&text=${u}\n\n${t}&disable_web_page_preview=true`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};if(Mo&&qo){const u=(await Promise.resolve().then((function(){return o(require("tunnel"))}))).httpsOverHttp({proxy:{host:Mo,port:+qo,proxyAuth:Ho},maxSockets:1});Object.assign(n,{httpsAgent:u})}So.post(n).then((u=>{u.ok?hi.info("Telegram发送通知消息成功🎉。"):400===u.error_code?hi.info("请主动给bot发送一条消息并检查接收用户ID是否正确。"):401===u.error_code&&hi.info("Telegram bot token 填写错误。")})).catch((u=>{hi.info("telegram发送通知消息失败！！"),hi.info(u)})).finally((()=>{e("")}))}else e("")}))}function aa(u,t){return new Promise((e=>{const n={url:`https://oapi.dingtalk.com/robot/send?access_token=${Ko}`,data:{msgtype:"text",text:{content:` ${u}\n\n${t}`}},headers:{"Content-Type":"application/json"},timeout:15e3};if(Ko){if(zo){const u=require("crypto"),t=Date.now(),e=u.createHmac("sha256",zo);e.update(`${t}\n${zo}`);const r=encodeURIComponent(e.digest("base64"));n.url=`${n.url}&timestamp=${t}&sign=${r}`}So.post(n).then((u=>{0===u.errcode?hi.info("钉钉发送通知消息成功🎉。"):hi.info(`钉钉发送通知失败：${u.errmsg}`)})).catch((u=>{hi.info("钉钉发送通知消息失败！！"),hi.info(u)})),e("")}else e("")}))}function sa(u,t){return new Promise((e=>{const n={url:`https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=${Yo}`,data:{msgtype:"text",text:{content:` ${u}\n\n${t}`}},headers:{"Content-Type":"application/json"},timeout:15e3};Yo&&So.post(n).then((u=>{0===u.errcode?hi.info("企业微信发送通知消息成功🎉。"):hi.info(`企业微信发送通知失败：${u.errmsg}`)})).catch((u=>{hi.info("企业微信发送通知消息失败！！"),hi.info(u)})).finally((()=>{e("")})),e("")}))}function ca(u){const t=Qo.split(",");if(t[2]){const e=t[2].split("|");let n="";for(let t=0;t<e.length;t++){const r="签到号 "+(t+1);u.match(r)&&(n=e[t])}return n||(n=t[2]),n}return"@all"}function Da(u,t){return new Promise((e=>{if(Qo){const n=Qo.split(","),r={url:"https://qyapi.weixin.qq.com/cgi-bin/gettoken",data:{corpid:`${n[0]}`,corpsecret:`${n[1]}`},headers:{"Content-Type":"application/json"},timeout:15e3};So.post(r).then((r=>{const i=t.replace(/\n/g,"<br/>"),o=JSON.parse(r).access_token;let a;switch(n[4]){case"0":a={msgtype:"textcard",textcard:{title:`${u}`,description:`${t}`,url:"https://github.com/whyour/qinglong",btntxt:"更多"}};break;case"1":a={msgtype:"text",text:{content:`${u}\n\n${t}`}};break;default:a={msgtype:"mpnews",mpnews:{articles:[{title:`${u}`,thumb_media_id:`${n[4]}`,author:"智能助手",content_source_url:"",content:`${i}`,digest:`${t}`}]}}}n[4]||(a={msgtype:"text",text:{content:`${u}\n\n${t}`}}),a={url:`https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=${o}`,data:{touser:`${ca(t)}`,agentid:`${n[3]}`,safe:"0",...a},headers:{"Content-Type":"application/json"}},So.post(a).then((u=>{0===u.errcode?hi.info("成员ID:"+ca(t)+"企业微信应用消息发送通知消息成功🎉。"):hi.info(`企业微信应用：${u.errmsg}`)})).catch((u=>{hi.info("成员ID:"+ca(t)+"企业微信应用消息发送通知消息失败！！"),hi.info(u)})).finally((()=>{e("")}))})).catch((u=>{hi.error("企业微信应用消息发送通知消息失败！！")}))}else e("")}))}function fa(u,t,e={}){return new Promise((n=>{if(Vo){if(!new RegExp("^[a-zA-Z0-9]{24}$").test(Vo))return hi.info("您所提供的IGOT_PUSH_KEY无效"),void n("");const r={url:`https://push.hellyw.com/${Vo.toLowerCase()}`,params:`title=${u}&content=${t}&${N(e)}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};So.post(r).then((u=>{"string"==typeof u&&(u=JSON.parse(u)),0===u.ret?hi.info("iGot发送通知消息成功🎉"):hi.info(`iGot发送通知消息失败：${u.errMsg}`)})).catch((u=>{hi.info("发送通知调用API失败！！"),hi.info(u)})).finally((()=>{n("")}))}else n("")}))}function la(u,t){return new Promise((e=>{if(Wo){t=t.replace(/[\n\r]/g,"<br>");const n={url:"https://www.pushplus.plus/send",params:{token:`${Wo}`,title:`${u}`,content:`${t}`,topic:`${Xo}`},headers:{"Content-Type":" application/json"},timeout:15e3};So.post(n).then((u=>{200===u.code?hi.info(`push+发送${Xo?"一对多":"一对一"}通知消息完成。`):hi.info(`push+发送${Xo?"一对多":"一对一"}通知消息失败：${u.msg}`)})).catch((u=>{hi.info(`push+发送${Xo?"一对多":"一对一"}通知消息失败！！`),hi.info(u)})).finally((()=>{e("")}))}else e("")}))}async function da(u,t){hi.info("----【消息推送】----"),u=`Bili-${wo.nickname}-${u}`,await async function(u,t,e={},n="\n\n本通知 By：https://github.com/catlair/BiliTools"){Lo(),t+=n,await Promise.all([na(u,t),la(u,t)]),await Promise.all([ia(u,t,e),oa(u,t),aa(u,t),sa(u,t),Da(u,t),fa(u,t,e),ta(u,t),ea(u,t),ra(u,t)])}(u,t,void 0,"")}const Ca=$o({baseURL:E,headers:{"user-agent":Bo.USER_AGENT}}),pa=$o({baseURL:g,headers:{Referer:A,"user-agent":Bo.USER_AGENT}}),Fa=$o({baseURL:m,headers:{Referer:A,"user-agent":Bo.USER_AGENT}}),Aa=$o({baseURL:h,headers:{"user-agent":Bo.USER_AGENT}}),Ea=$o({baseURL:y,headers:{"user-agent":Bo.USER_AGENT}});function ga(u=1,t=50,e=1){return pa.get(`/xlive/app-ucenter/v1/fansMedal/panel?page=${u}&page_size=${t}&target_id=${e}`)}function ma({ruid:u,gift_num:t,bag_id:e,gift_id:n,roomid:r}){const i=Bo.BILIJCT,o=i,a={gift_id:n,ruid:u,gift_num:t,bag_id:e,biz_id:r,rnd:(new Date).getTime(),send_ruid:0,storm_beat_id:0,metadata:"",price:0,visit_id:"",csrf:i,platform:"pc",biz_code:"Live",csrf_token:o,uid:Bo.USERID};return pa.post("/xlive/revenue/v2/gift/sendBag",a,{headers:{Origin:d}})}function ha(u){return pa.get(`/xlive/lottery-interface/v1/Anchor/Check?roomid=${u}`)}function ya(){return Fa.get("/x/web-interface/nav",{headers:{Origin:l}})}function Ba(){return Fa.get("/x/web-interface/coin/today/exp")}function wa(u=1,t=50,e=-10){return Fa.get("/x/relation/tag",{params:{tagid:e,pn:u,ps:t}})}function va(u,t){return Fa.post("/x/relation/tags/addUsers?cross_domain=true",{fids:u,tagids:t,csrf:Bo.BILIJCT},{headers:{Origin:C}})}function _a(u){const t=u.level_info,e=t.current_level;if(e>=Bo.BILI_TARGET_LEVEL&&(wo.coinsTask=0),hi.info(`当前等级: ${t.current_level}`),e>=6){const u=Bo.function;u.shareAndWatch=!1,u.addCoins=!1,u.taskReward=!1,hi.info("已经满级，不需要再投币了，做个白嫖怪吧")}else{const u=t.next_exp-t.current_exp;hi.info(`距离升级还需要 ${u} 经验，预计 ${function(u){if(Bo.BILI_TARGET_COINS<=0)return u/15;const t=10*Bo.BILI_TARGET_COINS+15,e=u/t,n=wo.money/(Bo.BILI_TARGET_COINS-1);return e<n?Math.floor(e):(u-n*t)/25+n}(u).toFixed(2)} 天`)}}async function ba(u){try{var t;const{data:e}=await Ca.get("/site/getCoin");hi.info(`登录成功: ${u.uname}`),hi.info(`硬币余额: ${e.money||0}`),wo.nickname=function(u){const t=u.length;return t<=3?u:`${u[0]}**${u[t-1]}`}(u.uname),wo.money=e.money||0,wo.userLevel=u.level_info.current_level,wo.bCoinCouponBalance=(null===(t=u.wallet)||void 0===t?void 0:t.coupon_balance)||0,_a(u),function(u){let t="";switch(wo.vipType=u.vipType,u.vipType){case 0:t="无大会员";break;case 1:t="月度大会员";break;case 2:t="年度大会员"}0===u.vipStatus&&(t="无大会员"===t?t:t+"[已过期]"),hi.info(`大会员状态: ${t}`)}(u)}catch(u){hi.error(`获取硬币信息异常: ${u.message}`),hi.debug(u)}}function $a(u,t,e=1){return Fa.post("/x/web-interface/coin/add",{aid:u,multiply:t,selectLike:e,csrf:Bo.BILIJCT})}function Sa(u,t=1){return To.post("https://www.bilibili.com/audio/music-service-c/web/coin/add",{sid:u,multiply:t,csrf:Bo.BILIJCT})}const Ta="video",Ia="audio",Oa="article";async function Pa(u=!0){try{const t=Bo.USERID,{data:e,message:n,code:r}=await(u?function(u=1,t=50){return wa(u,t,-10)}():function(u,t=1,e=50,n="desc",r="attention"){return Fa.get("/x/relation/followings",{params:{vmid:u,pn:t,ps:e,order:n,order_type:r}})}(t)),i=u?e:e.list;if(!i||0===i.length)return{msg:"-1",data:{}};if(0===r){await Po();const{mid:u}=U(i)||{};return await ka(u)}return{msg:u?`未获取到特别关注列表: ${r}-${n}`:`未获取到关注列表: ${r}-${n}`,data:{}}}catch(u){return{msg:u.message,data:{}}}}async function xa(){const u=U([1,3,4,5,160,22,119]);try{const{data:t,message:e,code:n}=await function(u=1,t=3){return Fa.get("/x/web-interface/ranking/region",{params:{rid:u,day:t}})}(u,3);if(0==n){const{aid:u,title:e,author:n}=U(t);return{msg:"0",data:{id:Number(u),title:e,author:n}}}return{msg:`未获取到排行信息: ${n}-${e}`,data:{}}}catch(u){return{msg:u.message,data:{}}}}async function La(){const u=Bo.BILI_CUSTOMIZE_UP;return 0===u.length?{msg:"-1",data:{}}:await ka(U(u))}async function ka(u){try{const{code:t,data:e,message:n}=await function(u){return Fa.get(`/x/space/navnum?mid=${u}`)}(u);if(t)return{msg:`通过uid获取视频失败: ${t}-${n}`,data:{}};await Po();const{video:r,audio:i,article:o}=e,{type:a,page:s,index:c}=function([u,t,e]){const n=u+t+e;if(!n)return;const r=O(0,n-1);let i=r;if(r<u)return{type:Ta,page:I(30,i+1),index:i%30};const o=u+t;return i=r-u,r<o?{type:Ia,page:I(30,i+1),index:i%30}:(i=r-o,{type:Oa,page:I(12,i+1),index:i%12})}([r,i,o]),D={[Ta]:Na,[Ia]:Ua,[Oa]:Ra},f=await D[a](u,s,c);return f.message?{msg:f.message,data:{}}:{msg:"0",data:f}}catch(u){return hi.debug(u),{msg:u.message,data:{}}}}async function Na(u,t,e){const{code:n,data:r,message:i}=await function(u,t=30,e=1,n=""){return Fa.get("/x/space/arc/search",{params:{jsonp:"jsonp",order:"pubdate",keyword:n,pn:e,tid:0,ps:t,mid:u}})}(u,30,t);if(n)return{message:i};const{aid:o,title:a,author:s}=r.list.vlist[e];return{type:Ta,id:o,title:a,author:s}}async function Ua(u,t,e){const{code:n,data:r,msg:i}=await function(u,t=30,e=1){return Fa.get("/audio/music-service/web/song/upper",{params:{jsonp:"jsonp",order:1,pn:e,ps:t,uid:u}})}(u,30,t);if(n)return{message:i};const{data:o}=r,{id:a,uname:s,title:c}=o[e];return{type:Ia,id:a,title:c,author:s}}async function Ra(u,t,e){const{code:n,data:r,message:i}=await function(u,t=12,e=1){return Fa.get("/x/space/article",{params:{callback:"__test",jsonp:"jsonp",sort:"publish_time",pn:e,ps:t,mid:u},requestOptions:{isJsonp:!0}})}(u,12,t);if(n)return{message:i};const{articles:o}=r,{id:a,title:s,author:{name:c}}=o[e];return{type:Oa,id:a,title:s,author:c,mid:u}}const ja=function(){const u=[La,Pa,()=>Pa(!1),xa];return Bo.BILI_CUSTOMIZE_UP||u.shift(),u}();async function Ga(u=0){ja.splice(0,wo.currentStartFun+u);for(let u=0;u<ja.length;u++){const t=ja[u];let e=Number(Bo.BILI_COIN_RETRY_NUM??4);for(e=e<1?1:e>8?8:e;e--;){await Po();const u=await t();if("-1"===u.msg&&(e=0),"0"===u.msg)return u}e<=0&&(wo.currentStartFun=u)}return{msg:"-1",data:{id:0}}}async function Ma({id:u,coin:t=1,type:e="video",mid:n}){const r={[Ta]:$a,[Ia]:Sa,[Oa]:(u,t=1)=>function(u,t,e=1){return Fa.post("/x/web-interface/coin/add",{aid:t,upid:u,avtype:2,multiply:e,csrf:Bo.BILIJCT})}(n,u,t)},i=await r[e](Number(u),t);return{code:i.code,message:i.message||i.msg}}async function qa(u){if(await async function(){try{const{data:u,code:t}=await Ba();if(0==t){const t=Bo.BILI_TARGET_COINS-u/10;wo.coinsTask=t>0?t:0}}catch(u){}}(),wo.coinsTask<=0||wo.money<=0)return!0;const{data:t,msg:e}=await Ga(u.priority);return null!=t&&t.id&&"0"==e?(await Po(),await async function(u,t){const{id:e,title:n,author:r,type:i,mid:o}=u;try{const u=await Ma({id:e,type:i,mid:o});if(0===u.code)wo.money--,wo.coinsTask--,t.num++,hi.info(`给[${n}--up【${r}】]投币成功`);else if(34005===u.code)t.fillCount++,hi.verbose(`当前稿件[${e}]不能再投币了`),t.fillCount>=3&&(hi.warn("自定义用户组投币似乎没有币可投了"),t.priority++);else{if(-111===u.code||-104===u.code)return hi.warn(`${e} ${u.message} 无法继续进行投币`),!0;if(t.eCount++,hi.warn(`给${e}投币失败 ${u.code} ${u.message}`),t.prevCode===u.code)return!0;t.prevCode=u.code}}catch(u){t.eCount++,hi.error(`投币异常 ${u.message}`)}finally{await Po(1500)}return!1}(t,u)):(u.eCount++,!1)}async function Ha(){try{const{data:u,code:t,message:e}=await Ea.get("/link_group/v1/member/my_groups");return 0===t?(null==u?void 0:u.list)||[]:(hi.warn(`获取自己的应援团异常失败: ${e}`),[])}catch(u){hi.error(`获取自己的应援团异常: ${u}`)}}const Ja=["(⌒▽⌒)","（￣▽￣）","(=・ω・=)","(｀・ω・´)","(〜￣△￣)〜","(･∀･)","(°∀°)ﾉ","(￣3￣)","╮(￣▽￣)╭","_(:3」∠)_","( ´_ゝ｀)","←_←","→_→","(<_<)","(>_>)","(;¬_¬)","(ﾟДﾟ≡ﾟдﾟ)!?","Σ(ﾟдﾟ;)","Σ( ￣□￣||)","(´；ω；`)","（/TДT)/","(^・ω・^ )","(｡･ω･｡)","(●￣(ｴ)￣●)","ε=ε=(ノ≧∇≦)ノ","(´･_･`)","(-_-#)","（￣へ￣）","(￣ε(#￣) Σ","ヽ(`Д´)ﾉ","（#-_-)┯━┯","(╯°口°)╯(┴—┴","←◡←","( ♥д♥)","Σ>―(〃°ω°〃)♡→","⁄(⁄ ⁄•⁄ω⁄•⁄ ⁄)⁄","(╬ﾟдﾟ)▄︻┻┳═一","･*･:≡(　ε:)","(汗)","(苦笑)"].concat("1","2","3","4","5","6","7","8","9","签到","哈哈"),Ka=new mi({console:"debug",file:"debug"},"live");async function za(){let u=99,t=0;const e=[];try{for(;t<u;){const{code:n,message:r,data:i}=await ga(t+1,50,Bo.USERID);if(0!==n)return hi.verbose(`获取勋章信息失败 ${n} ${r}`),null;if(!i)return e;u=i.page_info.total_page,t=i.page_info.current_page,e.push(...i.list,...i.special_list)}return e}catch(u){return hi.error(`获取勋章异常 ${u.message}`),null}}function Ya({room_info:u,medal:t}){if(null==u||!u.room_id)return!1;if(t.level>=20)return!1;if(t.today_feed>=t.day_limit)return!1;const{whiteList:e,blackList:n}=Bo.intimacy;return e&&e.length?!!e.includes(u.room_id):!n||!n.includes(u.room_id)}async function Qa(u,t){const e=Ja[O(Ja.length-1)];try{const{code:n,message:r}=await function(u,t){const e=Bo.BILIJCT,n=e;return t||(t=O(10).toString()),pa.post("/msg/send",{color:5566168,fontsize:25,mode:1,msg:t,rnd:Date.now(),roomid:u,bubble:0,csrf:e,csrf_token:n})}(u,e);return 0===n||(11e3===n?(hi.warn(`【${t}】${u}-可能未开启评论`),!1):(hi.warn(`【${t}】${u}-发送失败 ${r}`),hi.verbose(`code: ${n}`),!1))}catch(u){hi.verbose(`发送弹幕异常 ${u.message}`)}}async function Va(u){try{const{code:e,message:n,data:r}=await(t=u,pa.post("xlive/web-room/v1/index/TrigerInteract",{roomid:t,interact_type:3,csrf:Bo.BILIJCT,csrf_token:Bo.BILIJCT,visit_id:""}));if(0===e)return r;hi.info(`【${u}】直播间分享失败 ${e} ${n}`)}catch(t){hi.warn(`分享直播间 [${u}] 异常 ${t.message}`)}var t}async function Wa(u){try{const{code:e,message:n,data:r}=await(t=u,pa.post("xlive/web-ucenter/v1/interact/likeInteract",{roomid:t,csrf:Bo.BILIJCT,csrf_token:Bo.BILIJCT}));if(0===e)return r;hi.info(`【${u}】直播间点赞失败 ${e} ${n}`)}catch(u){hi.warn(`点赞直播间异常 ${u.message}`)}var t}async function Xa(){const u=(t=await za())&&0!==t.length?t.filter(Ya):[];var t;for(let t=0;t<u.length;t++){const e=u[t];await Za(e)}}async function Za(u){const{room_info:t,anchor_info:e}=u;if(!t||!e)return;const{liveLike:n,liveSendMessage:r,liveShare:i}=Bo.intimacy,o=e.nick_name,a=t.room_id;r&&(Ka.verbose(`【${o}】开始发送直播弹幕`),await Qa(a,o)),i&&async function(){await Po(100,300);for(let u=0;u<5;u++)Ka.verbose(`分享 [${o}] 直播间`),await Va(a),await Po(4e3)}().catch((u=>hi.error(u))),n&&async function(){await Po(100,300);for(let u=0;u<3;u++)Ka.verbose(`给 [${o}] 直播间点赞`),await Wa(a),await Po(6500)}().catch((u=>hi.error(u))),await Po(22e3)}async function us(){try{const{data:u,message:t,code:e}=await ya();if(0!==e)return void hi.warn(`获取用户信息失败：${e} ${t}`);!function(u){var t;wo.bCoinCouponBalance=(null===(t=u.wallet)||void 0===t?void 0:t.coupon_balance)||0}(u)}catch(u){hi.error(`获取用户信息异常：${u.message}`)}}var ts;function es(){const u=T(),t=u.getDate(),e=function(u){const t=u||T(),e=t.getFullYear(),n=t.getMonth()+1;return 2===n?e%4==0&&e%100!=0||e%400==0?29:28:[4,6,9,11].includes(n)?30:31}(u),n=Bo.CHARGE_PRESET_TIME;return wo.bCoinCouponBalance<2?(hi.info(`剩余券为${wo.bCoinCouponBalance}，不足2跳过充电`),!1):e===t?(hi.info("今天是最后一天了"),!0):!(n>t)||(hi.info(`预设时间为${n}，不符合条件`),!1)}async function ns(){try{const{data:u,code:t,message:e}=await Fa.get("/x/vip/privilege/my",{headers:{origin:l,referer:A}});if(0!==t)return void hi.info(`获取领取状态失败：${t} ${e}`);const{list:n}=u;return n.slice(0,2).filter((u=>{const t=parseInt(((new Date).getTime()/1e3).toString());return 0===u.state&&t>u.period_end_unix}))}catch(u){hi.error(`获取领取状态出现异常：${u.message}`)}}async function rs(u){try{const t=function(u){switch(u){case 1:return"B 币券";case 2:return"大会员优惠券";default:return""}}(u),{code:e,message:n}=await function(u=1){return Fa.post("/x/vip/privilege/receive",{csrf:Bo.BILIJCT,type:u},{headers:{origin:F,referer:A}})}(u);let r="成功";return 0===e&&(r=`失败 ${n}`),hi.info(`领取${t} ${r}`),!0}catch(u){hi.error(`领取权益出现异常：${u.message}`)}return!1}async function is(u){let t=0,e=!1;for(;!(e||(e=await rs(u),t>2));)t++;return e}!function(u){u[u["成功"]=4]="成功",u[u["低于20电池"]=-2]="低于20电池",u[u["B币不足"]=-4]="B币不足"}(ts||(ts={}));let os=0;async function as(){try{const{data:{list:u}}=await function(u=3394945){const t=(new Date).getTime();return pa.get(`/xlive/web-room/v1/gift/bag_list?t=${t}&room_id=${u}`)}();return u.filter((u=>{if(u.expire_at<=0)return!1;const t=(1e3*u.expire_at-(new Date).getTime())/864e5<2,e=![1,30607].includes(u.gift_id);return e&&t&&hi.info(`${u.gift_name} 即将过期请尽快投喂`),!e&&t}))}catch(u){if(os)return null;await as(),os++}}async function ss(u){try{const{data:{live_room:t,name:e}}=await function(u){return Fa.get(`/x/space/acc/info?mid=${u}&jsonp=jsonp`)}(u);if(await Po(),t.roomStatus)return{roomid:t.roomid,name:e}}catch{}}function cs(u,t,e,n){const r=Bo.BILIJCT,i={is_fav:0,main_id:t,oid:u,detail_id:e,count:n,csrf:r,csrf_token:r};return Fa.post("/x/esports/guess/add",i)}function Ds(){return wo.money-Bo.MATCH_COINS<Bo.BILI_TARGET_COINS&&(hi.info(`需要保留${Bo.BILI_TARGET_COINS}个硬币，任务结束`),!0)}async function fs(){const{data:u,code:t}=await wa(1,1,0);if(0!==t)throw new Error(`获取最后一个关注失败: ${t}`);return u[0]}async function ls(u){const{data:t,code:e}=await Fa.get("/x/relation/tags?jsonp=jsonp&callback=__jp3",{headers:{Referer:"https://space.bilibili.com/1/fans/follow?tagid=0"},requestOptions:{isJsonp:!0}});if(0===e)return t.find((t=>t.name===u));hi.warn(`获取分组列表失败: ${e}`)}async function ds(u){const t=await ls(u);if(t)return t.tagid;await Po(300);const{data:e,code:n,message:r}=await(i=u,Fa.post("/x/relation/tag/create",{tag:i,jsonp:"jsonp",csrf:Bo.BILIJCT}));var i;if(22106===n){await Po(300);const t=await ls(u);return t&&t.tagid}return 0!==n&&hi.warn(`创建分组失败: ${n}-${r}`),e.tagid}async function Cs(u,t="天选时刻"){if(0===u.length)return;const e=await ds(t);if(e)for(const t of u){const{code:u,message:n}=await va(t.mid,e);0!==u&&hi.warn(`移动【${t.uname}】失败: ${u}-${n}`),await Po()}}async function ps(u,t,e,n=1){if(u.length>t.length)return;const{data:r,code:i,message:o}=await wa(n,20,0);if(0===i){for(const{mid:n,uname:i}of r){if(u.length>=t.length)return;if(n===e)return;(t.includes(n)||t.includes(i))&&u.push({mid:n,uname:i})}if(!(r.length<20))return await ps(u,t,e,n+1)}else hi.warn(`获取关注用户失败: ${i}-${o}`)}const Fs=0,As=1,Es=5,gs=1,ms=504,hs=1096;let ys;async function Bs(){try{const{data:u,code:t,message:e}=await pa.get("/xlive/web-interface/v1/index/getWebAreaList?source_id=2");return 0!==t&&hi.info(`获取直播分区失败: ${t}-${e}`),u.data.map((u=>u.list)).map((u=>u.map((u=>({areaId:u.id,parentId:u.parent_id})))))}catch(u){throw hi.error(`获取直播分区异常: ${u.message}`),u}}async function ws(u,t,e=1,n="lottery"){try{await Po(100);const{data:r,code:i,message:o}=await function(u,t,e=1){return pa.get(`/xlive/web-interface/v1/second/getList?platform=web&parent_area_id=${u}&area_id=${t}&page=${e}`)}(t,u,e);return 0!==i&&hi.info(`获取直播间列表失败: ${i}-${o}`),function(u){const t=[],e=[];return u.forEach((u=>{const n=u.pendant_info[2];n&&(n.pendent_id===ms?t.push(u):n.pendent_id===hs&&e.push(u))})),{lotteryTime:t,lotteryPacket:e}}(r.list)["lottery"===n?"lotteryTime":"lotteryPacket"]}catch(u){throw hi.error(`获取直播间列表异常: ${u.message}`),u}}async function vs(u,t,e=1){const n=await ws(u,t,e),r=[];for(const u of n){const t=await _s(u);t&&(r.push({...t,uid:u.uid,uname:u.uname}),await Po(100))}return r}async function _s(u){const{blackUid:t}=Bo.lottery;if(t.includes(u.uid))return void hi.info(`跳过黑名单用户: ${u.uname}`);let e,n,r;try{({data:n,code:e,message:r}=await ha(u.roomid))}catch(t){return void hi.info(`直播间${u.roomid}检测异常: ${t.message}`)}if(0!==e)return void hi.debug(`直播间${u.roomid}检测失败: ${e}-${r}`);if(null===n)return;const{excludeAward:i,includeAward:o}=Bo.lottery,a=i.some((u=>n.award_name.match(u)));if(o.some((u=>n.award_name.match(u)))||!a){if(n.status===gs&&!(n.gift_price>0))return 4===n.require_type&&(hi.info("您能反馈给作者输出了什么吗？"),hi.info(`${n.require_type}--${n.require_text}--${n.require_value}`),hi.info("也许这正是我们想要的。")),n.require_type===Es&&wo.userLevel>=n.require_value||n.require_type===Fs?n:n.require_type!==As||Bo.lottery.skipNeedFollow?void 0:n}else hi.info(`跳过屏蔽奖品: ${n.award_name}`)}async function bs(u,t=!0){try{const{id:n,gift_id:r,gift_num:i,award_name:o,uid:a,uname:s,require_type:c,require_text:D}=u;hi.info(`天选主播：【${s}】`),hi.info(`奖品：${o}`);const{code:f,message:l}=await(e={id:n,gift_id:r,gift_num:i},pa.post("/xlive/lottery-interface/v1/Anchor/Join",{...e,csrf:Bo.BILIJCT,csrf_token:Bo.BILIJCT,visit_id:P(),platform:"pc"}));if(0!==f)return void hi.info(`天选失败: ${f}-${l}`);if(hi.info("天选成功 √"),c===As&&t){x(ys,a);(function(u){const t=(u=u.replace("关注主播","")).split(/\s*\+\s*/);return t.shift(),t})(D).forEach((u=>x(ys,u)))}}catch(u){hi.info(`天选异常: ${u.message}`)}var e}async function $s(u,t,e=2){for(let n=1;n<=e;n++){const e=await vs(u,t,n);for(const u of e)await bs(u),await Po(300)}}async function Ss(u){try{const{data:t,code:e}=await function(u){return pa.get(`/xlive/lottery-interface/v1/lottery/getLotteryInfoWeb?roomid=${u}`)}(u);if(0!==e)return;const{popularity_red_pocket:n}=t;if(!n)return;const{lot_id:r,lot_status:i}=n[0];if(2===i)return;return r}catch(u){}}async function Ts(u,t,e=1){const n=await ws(u,t,e,"redPack"),r=[];for(const u of n){const t=await Ss(u.roomid);t&&(r.push({uid:u.uid,uname:u.uname,lot_id:t,room_id:u.roomid}),await Po(100))}return r}async function Is(u){try{const{lot_id:e,uid:n,uname:r,room_id:i}=u;hi.info(`红包主播：【${r}】`);const{code:o,message:a}=await(t={room_id:i,lot_id:e,ruid:n},pa.post("/xlive/lottery-interface/v1/popularityRedPocket/RedPocketDraw",{...t,spm_id:"444.8.red_envelope.extract",jump_from:"",session_id:"",csrf_token:Bo.BILIJCT,csrf:Bo.BILIJCT,visit_id:""}));if(0!==o)return void hi.info(`红包失败: ${o}-${a}`);ys.push(n),hi.info("红包成功 √")}catch(u){hi.info(`红包异常: ${u.message}`)}var t}async function Os(u,t,e=2){for(let n=1;n<=e;n++){const e=await Ts(u,t,n);for(const u of e)await Is(u),await Po(200)}}async function Ps(){const u=[];return await async function t(e=1){try{var n;const{data:r,code:i,message:o}=await function(u=1,t=9){return pa.get(`/xlive/web-ucenter/user/following?page=${u}}&page_size=${t}`)}(e,9);if(0!==i)return void hi.info(`获取关注直播间失败: ${i}-${o}`);const a=null===(n=r.list)||void 0===n?void 0:n.filter((u=>1===u.live_status));if(9===a.length&&e<r.totalPage)return u.push(...a),t(e+1);u.push(...a)}catch(u){hi.error(`获取关注直播间异常: ${u.message}`)}}(),u}async function xs(u){try{const{code:t,message:e,data:n}=await ha(u.roomid);if(0!==t)return void hi.debug(`直播间${u.roomid}检测失败: ${t}-${e}`);if(null===n)return;if(n.status!==gs)return;if(n.gift_price>0)return;return n}catch(t){return void hi.info(`直播间${u.roomid}检测异常: ${t.message}`)}}async function Ls(){const{scanFollow:u}=Bo.lottery;if(!u)return!0;try{hi.info("开始扫描关注的主播");const u=await async function(){const u=await Ps(),t=[];for(const e of u){const u=await xs(e);u&&t.push({...u,uid:e.uid,uname:e.uname}),await Po(100)}return t}();for(const t of u)await bs(t,!1),await Po(300);hi.info("关注的主播天选完成")}catch(u){hi.error(`关注的主播天选异常: ${u.message}`)}return"only"!==u}async function ks(u){try{const{code:t,message:e,data:n}=await function({session_type:u}={session_type:1}){return Ea.get(`/session_svr/v1/session_svr/get_sessions?session_type=${u}&group_fold=1&unfollow_fold=1&sort_rule=2&build=0&mobi_app=web`)}();if(0!==t)return void hi.warn(`获取会话失败：${t}-${e}`);const{session_list:r}=n;if(r.length<=0)return;return r.filter((({unread_count:t,talker_id:e,is_follow:n,last_msg:r})=>{return u.find((u=>u.mid===e))&&t>0&&e===r.sender_uid&&1===n&&(i=r.timestamp,Date.now()-1e3*i<36e5);var i}))}catch(u){hi.error(`获取会话异常：${u.message}`)}}async function Ns(u){const t=await ks(u);await Po(200);try{for(let u=0;u<t.length;u++){const e=t[u];await Us(e)}}catch(u){hi.error(`更新会话异常：${u.message}`)}t.length>=19&&await Ns(u)}async function Us(u){switch(Bo.lottery.actFollowMsg){case"del":case"delete":await function({talker_id:u,session_type:t}){return Ea.post("/session_svr/v1/session_svr/remove_session",{talker_id:u,session_type:t,build:0,mobi_app:"web",csrf_token:Bo.BILIJCT,csrf:Bo.BILIJCT})}(u);break;case"read":await function({talker_id:u,session_type:t,ack_seqno:e}){return Ea.post("/session_svr/v1/session_svr/update_ack",{talker_id:u,session_type:t,ack_seqno:e,build:0,mobi_app:"web",csrf_token:Bo.BILIJCT,csrf:Bo.BILIJCT},{headers:{origin:p}})}(u)}await Po(50)}var Rs={taskReward:async function(){hi.info("----【每日任务完成情况】----");try{const{data:u,message:t,code:e}=await Fa.get("/x/member/web/exp/reward");await Po();const{data:n}=await Ba();if(0!=e)return void hi.warn(`状态获取失败: ${e} ${t}`);const r=wo.money-Bo.BILI_STAY_COINS;let i=0;0===wo.coinsTask?hi.info(`今日投币获取经验: ${n}，还需投币0颗，经验够了，不想投了`):r<=0?hi.info(`今日投币获取经验: ${n}，还需投币0颗，硬币不够了，不投币了`):r<wo.coinsTask?(i=wo.coinsTask-r,hi.info(`投币获取经验: ${n}，还需投币数量: ${i}颗;(目标${wo.coinsTask}颗，忽略部分投币)`)):(i=wo.coinsTask-n/10,hi.info(`投币获取经验: ${n}，还需投币数量: ${i}颗;(目标${wo.coinsTask}颗)`)),wo.coinsTask=i,hi.info("每日分享: "+(u.share?"已完成":"[未完成]")),hi.info("每日播放: "+(u.watch?"已完成":"[未完成]")),wo.share=u.share,wo.watch=u.watch}catch(u){hi.error(`状态获取异常 ${u.message}`)}},liveSignTask:async function(){hi.info("----【直播签到】----");try{const{data:u}=await pa.get("/xlive/web-ucenter/v1/sign/WebGetSignInfo");if(1===u.status)return hi.info("已签到，跳过签到"),void hi.info(`已经签到${u.hadSignDays}天，${u.specialText}`)}catch(u){}try{const{code:u,data:t,message:e}=await pa.get("/xlive/web-ucenter/v1/sign/DoSign");0===u?hi.info(`直播签到成功: ${t.text}，特别信息: ${t.specialText}，本月签到天数: ${t.hadSignDays}天;`):hi.warn(`直播签到失败: ${u} ${e}`)}catch(u){hi.error(`直播签到异常: ${u.message}`)}},shareAndWatch:async function(){if(hi.info("----【分享/播放视频】----"),wo.share&&wo.watch)return void hi.info("已完成，跳过分享/播放");let u=0;try{let t=await Ga();if("-1"===t.msg&&(t=await xa()),"0"!==t.msg)return hi.warn(`获取视频失败 ${t.msg}`),!1;{const{id:e,author:n,title:r}=t.data;u=e,hi.info(`获取视频: ${r} --up【${n}】`)}}catch(u){return hi.error(`获取视频出现异常: ${u.message}`),!1}if(!wo.share){await Po();try{const{code:t,message:e}=await function(u){const t={csrf:Bo.BILIJCT,aid:u};return Fa.post("/x/web-interface/share/add",t)}(u);0===t?hi.info("分享视频成功!"):hi.warn(`分享视频失败: ${t} ${e}`)}catch(u){hi.error(`分享视频异常: ${u.message}`)}}if(!wo.watch){await Po();try{const{code:n,message:r}=await(t=u,e=O(4,60),Fa.post("/x/click-interface/web/heartbeat",{aid:t,played_time:e}));0===n?hi.info("播放视频成功!"):hi.warn(`播放视频失败: ${n} ${r}`)}catch(u){hi.error(`播放视频异常: ${u.message}`)}}var t,e},silver2Coin:async function(){hi.info("----【银瓜子兑换硬币】----");try{const{data:u,code:t,message:e}=await pa.get("/xlive/revenue/v1/wallet/getStatus");if(0!=t&&hi.info(`获取瓜子详情失败 ${e}`),0===u.silver_2_coin_left)hi.info("今日已兑换一次");else if(u.silver<700)hi.info("兑换失败，你瓜子不够了");else{const{message:u}=await pa.post("/xlive/revenue/v1/wallet/silver2coin",{csrf_token:Bo.BILIJCT,csrf:Bo.BILIJCT});hi.info(`兑换硬币： ${u}`),await pa.get("/xlive/revenue/v1/wallet/myWallet?need_bp=1&need_metal=1&platform=pc")}}catch(u){hi.error(`操作异常 ${u.message}`)}},addCoins:async function(){if(hi.info("----【视频投币】----"),!wo.coinsTask)return void hi.info("跳过投币，今日已完成");const u={eCount:0,num:0,prevCode:0,fillCount:0,priority:0};let t=!1;for(;wo.coinsTask&&!t&&u.eCount<5;)t=await qa(u);u.eCount>=5&&hi.info("出现异常/错误5次，自动退出投币"),hi.info(`一共成功投币${u.num}颗`),hi.info(`硬币还剩${wo.money}颗`)},mangaSign:async function(){hi.info("----【漫画签到】----");try{const{code:u}=await function(u="android"){return Aa.post("/twirp/activity.v1.Activity/ClockIn",{platform:u})}();0==u?hi.info("漫画签到成功"):hi.warn("漫画签到失败")}catch(t){var u;400===(null===(u=t.response)||void 0===u?void 0:u.status)?hi.info("已经签到过了，跳过任务"):hi.error(`漫画签到异常 ${t.message}`)}},supGroupSign:async function(){hi.info("----【应援团签到】----");const u=await Ha();await Po();let t=0;for(let r=0;r<u.length;){const i=u[r];try{const{data:u,code:r,message:o}=await(e=i.group_id,n=i.owner_uid,Ea.get("/link_setting/v1/link_setting/sign_in",{params:{group_id:e,owner_id:n}}));0===r?0===u.status?t++:hi.info(o):hi.warn(`[${i.group_name}]签到失败 ${o}`)}catch(u){hi.error(`签到异常 ${u.message}`)}finally{await Po()}}var e,n;hi.info(`签到结束，成功${t}/${u.length}`)},liveSendMessage:async function(){hi.info("----【发送直播弹幕】----"),hi.info("该函数即将废弃，请使用 liveIntimacy 替代");try{const u=await za(),t=u.length;let e=0,n=0;hi.info(`一共需要发送${t}个直播间`),hi.verbose("所需时间可能很长，请耐心等待");for(let r=0;r<t;r++){const{room_info:i,anchor_info:o,medal:a}=u[r];null!=i&&i.room_id?100===a.today_feed||a.level>=20?n++:(await Qa(i.room_id,o.nick_name)&&e++,r<t-1&&await Po(O(1e4,25e3))):(hi.info(`【${o.nick_name}】没有直播间哦`),n++)}hi.info(`成功发送${e}个弹幕，跳过${n}个`)}catch(u){hi.error(`直播间发送弹幕异常: ${u.message}`)}},charging:async function(){if(hi.info("----【给目标充电】----"),await us(),await Po(),es())try{const u=wo.bCoinCouponBalance||0,t=Bo.CHARGE_ID;let e=0;hi.info(`b 币券余额${u}`);const n=async()=>{const{code:e,message:n,data:r}=await function(u=50,t=!0,e=Bo.USERID,n="up",r=e){return Fa.post("/x/ugcpay/web/v2/trade/elec/pay/quick",{csrf:Bo.BILIJCT,bp_num:u,is_bp_remains_prior:t,up_mid:e,otype:n,oid:r})}(u,!0,t);0===e?(hi.info(`【充值结果】${ts[r.status]}`),r.status===ts["成功"]&&(wo.chargeOrderNo=r.order_no,await Po(),await async function(){try{if(!wo.chargeOrderNo)return!1;const u=w[O(0,w.length-1)],{code:t}=await function(u,t="支持大佬一波"){return Fa.post("/x/ugcpay/trade/elec/message",{csrf:Bo.BILIJCT,message:t,order_id:u})}(wo.chargeOrderNo,u);0===t&&hi.info("留言成功！")}catch{}}())):hi.warn(`充电失败：${e} ${n}`)};for(wo.chargeOrderNo="";!(wo.chargeOrderNo||(await n(),await Po(),e++>2)););}catch(u){hi.error(`充电出现异常：${u.message}`)}},getVipPrivilege:async function(){try{if(hi.info("----【领取大会员权益】----"),2!==wo.vipType)return hi.info("账号非年度大会员，不需要领取权益"),!1;const u=await ns();if(0===u.length)return void hi.info("已经领取过权益，不需要再领取");for(let t=0;t<u.length;t++){const e=u[t];await is(e.type)}}catch(u){hi.error(`领取大会员权益出现异常：${u.message}`)}},giveGift:async function(){hi.info("----【投喂过期食物】----");try{const u=await as();if(await Po(),null==u||!u.length)return void hi.info("没有2天内过期的简单礼物");const t=await async function(){const u=Object.assign([],Bo.BILI_GIFT_UP),t=()=>u.splice(O(Bo.BILI_GIFT_UP.length-1),1)[0];for(;u.length;){const u=t(),e=await ss(u);if(e)return{mid:u,...e}}return await async function(){const{data:{count:u,items:t}}=await function(u=1,t=10){return u>10&&(u=10),pa.get(`/xlive/app-ucenter/v1/user/GetMyMedals?page=${u}&page_size=${t}`)}();if(await Po(),!u)return;const e=t[O(t.length-1)];return{mid:e.target_id,roomid:e.roomid||0,name:e.uname}}()}();if(!t)return void hi.info("没有找到投喂目标");await async function({roomid:u,mid:t,name:e},n){for(const r of n){await Po();try{const{code:n,message:i,data:o}=await ma({roomid:u,ruid:t,bag_id:r.bag_id,gift_id:r.gift_id,gift_num:r.gift_num});if(0!==n){hi.warn(`向[${e}]投喂[${r.gift_name}]，${i}`);continue}o.gift_list.forEach((u=>{hi.info(`成功给 [${e}] 投喂${u.gift_name}`)}))}catch{}}}(t,u)}catch(u){hi.info(`投喂过期食物异常 ${u}`)}},matchGame:async function(){if(hi.info("----【赛事硬币竞猜】----"),Bo.MATCH_COINS<=0)return void hi.info("硬币数量不能小于 0");if(Ds())return;const u=await async function(){try{const{code:u,message:t,data:{list:e,page:n}}=await function(u="",t=""){return Fa.get(`/x/esports/guess/collection/question?pn=1&ps=50&gid=&sids=&stime=${u}&etime=${t}`)}();return 0!==u?void hi.warn(`获取赛事错误 ${u} ${t}`):0===n.total?(hi.info("今日已经无法获取赛事"),null):e}catch(u){}}();if(await Po(),!u)return;const t=await async function(u){let t=0;try{for(const e of u){const{contest:u,questions:n}=e,r=u.id,[{id:i,title:o,details:a,is_guess:s}]=n,[c,D]=a;if(Ds())return t;if(s)continue;hi.info(`${o} <=> ${c.odds}:${D.odds}`);const f=c.odds>D.odds;let l;l=Bo.MATCH_SELECTION>0?f?D:c:f?c:D,hi.info(`预测[ ${l.option} ] ${Bo.MATCH_COINS} 颗硬币`),await Po();const{code:d}=await cs(r,i,l.detail_id,Bo.MATCH_COINS);0!==d?hi.info("预测失败"):(t++,wo.money-=Bo.MATCH_COINS)}}catch(u){console.warn(u.message)}return t}(function(u,t){return u.filter((u=>{const{questions:e}=u,[{details:n,is_guess:r}]=e;if(r)return!1;const[i,o]=n;return Math.abs(i.odds-o.odds)>=t}))}(u,Bo.MATCH_DIFF));hi.info(`【竞猜结束】一共参与${t}次预测`)},liveLottery:async function(){hi.info("----【天选时刻】----");const u=await Ls();if(!u)return u;try{const u=await fs();hi.info(`最后一个关注的UP: ${u.uname}`);const t=await async function(){ys=[];const{pageNum:u}=Bo.lottery,t=await Bs();for(const e of t)for(const t of e)await $s(t.areaId,t.parentId,u);return ys}();hi.info("扫描完成");const e=[];await ps(e,t,null==u?void 0:u.mid),await Cs(e),hi.info("移动关注UP到分组成功")}catch(u){hi.warn(`天选时刻异常: ${u.message}`),hi.debug(u)}hi.info("结束天选时刻")},liveRedPack:async function(){hi.info("----【天选红包】----");try{const u=await fs();hi.info(`最后一个关注的UP: ${u.uname}`);const t=await async function(){ys=[];const{pageNum:u}=Bo.lottery,t=await Bs();for(const e of t)for(const t of e)await Os(t.areaId,t.parentId,u);return ys}();hi.info("扫描完成，获取新关注的UP");const e=[];await ps(e,t,null==u?void 0:u.mid),hi.info("开始读取消息"),await Ns(e),hi.info("移动关注UP到分组"),await Cs(e),hi.info("移动关注UP到分组成功")}catch(u){hi.warn(`天选时刻异常: ${u.message}`),hi.debug(u)}hi.info("结束天选红包")},liveIntimacy:async function(){hi.info("----【直播亲密度】----");try{await Xa(),hi.info("直播亲密度完成")}catch(u){hi.error(`直播亲密度: ${u.message}`)}}};var js=Object.freeze({__proto__:null,dailyTasks:async function(u,...t){mi.pushValue="";try{await async function(){hi.info("----【登录】----");const{data:u,message:t,code:e}=await ya();if(0!==e)throw hi.error(`登录错误 ${e} ${t}`),new Error(t);if(!u.isLogin)throw new Error("接口返回为未登录");await Po(),await ba(u)}()}catch(u){return hi.error(`登录失败: ${u}`),await da("登录失败",mi.pushValue),"未完成"}const e=Oo([...Object.values(Rs)]);for(const u of e)try{await u()}catch(t){hi.error(`${u.name}失败: ${t}`)}finally{await Po()}return u&&await u(...t),await da("每日完成",mi.pushValue),"完成"}});
